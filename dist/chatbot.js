(()=>{var t={227:t=>{!function(){"use strict";const e={githubUsername:"MihaiOnSoftware",openaiModel:"gpt-3.5-turbo",maxTokens:150,temperature:.7,githubKeywords:["github","repository","repo","repositories","code","commits","contributions","followers","following","projects"],github:{baseUrl:"https://api.github.com",repoLimit:10,eventLimit:5,displayRepoLimit:5,displayActivityLimit:3,excludePatterns:["nulogy/"]}};class n{constructor(){this.htmlContent=null,this.systemPrompt=null,this.conversationHistory=[]}async loadContentIndex(){const t=await fetch("html-files-index.json");if(!t.ok)throw new Error(`Failed to load content files index: ${t.status}`);return t.json()}async loadSingleContentFile(t){const e=await fetch(t),n=await e.text(),o=t.endsWith(".md")?"Markdown":"HTML";return`\n\n=== Content from ${t} (${o}) ===\n${n}`}async loadAllContentFiles(t){let e="";for(const n of t)e+=await this.loadSingleContentFile(n);return e}async loadContentFiles(){const t=await this.loadContentIndex();return this.loadAllContentFiles(t)}createSystemPrompt(t,e=""){return`\n            You are Mihai Popescu, a software developer, chatting casually about yourself. Keep responses short and conversational.\n\n            Here is your complete website content and professional information:\n            ${t}\n\n            ${e}\n\n            TONE & STYLE:\n            - Talk like you're having a casual conversation with a friend\n            - Keep answers brief (1-2 sentences max unless asked for details)\n            - Use "I" naturally - you ARE Mihai\n            - Be enthusiastic but not over-the-top\n            - Skip formal language - be relaxed and approachable\n\n            GUIDELINES:\n            - Answer from the info above, but keep it concise\n            - If someone asks about tech stuff, mention it briefly then ask if they want more details\n            - For GitHub questions, I can pull live stats\n            - If you don't know something, just say so casually\n            - Use emojis sparingly (maybe 1 per response max)\n            `}messageRequiresGithubStats(t){const n=t.toLowerCase();return e.githubKeywords.some(t=>n.includes(t))}shouldFilterRepo(t){const n=t.html_url||t.url||"",o=t.name||"",s=t.full_name||"";return e.github.excludePatterns.some(t=>n.includes(t)||o.includes(t)||s.includes(t))}shouldFilterEvent(t){const n=t.repo?.name||"";return e.github.excludePatterns.some(t=>n.includes(t))}buildGitHubUrl(t){return`${e.github.baseUrl}/users/${e.githubUsername}${t}`}async fetchGitHubData(t,e){try{const e=await fetch(t);return e.ok?await e.json():null}catch(t){return console.error(e,t),null}}async fetchGitHubStats(){try{const t=await this.fetchGitHubData(this.buildGitHubUrl(""),"Error fetching GitHub profile:");if(!t)return null;const[e,n]=await Promise.allSettled([this.fetchGitHubRepos(),this.fetchGitHubEvents()]);return{...this.extractBasicProfile(t),repositories:"fulfilled"===e.status?e.value:null,recent_activity:"fulfilled"===n.status?n.value:null}}catch(t){return console.error("Error fetching GitHub stats:",t),null}}extractBasicProfile(t){return{public_repos:t.public_repos,followers:t.followers,following:t.following,created_at:t.created_at,bio:t.bio,location:t.location,company:t.company}}async fetchGitHubRepos(){const t=this.buildGitHubUrl(`/repos?sort=updated&per_page=${e.github.repoLimit}`),n=await this.fetchGitHubData(t,"Error fetching GitHub repositories:");return n?n.filter(t=>!this.shouldFilterRepo(t)).map(this.transformRepo):null}async fetchGitHubEvents(){const t=this.buildGitHubUrl(`/events?per_page=${e.github.eventLimit}`),n=await this.fetchGitHubData(t,"Error fetching GitHub events:");return n?n.filter(t=>!this.shouldFilterEvent(t)).map(this.transformEvent.bind(this)).filter(t=>t.repo):null}transformRepo(t){return{name:t.name,description:t.description,language:t.language,stars:t.stargazers_count,updated_at:t.updated_at,url:t.html_url}}transformEvent(t){return{type:t.type,repo:t.repo?.name,created_at:t.created_at,action:this.formatEventAction(t)}}formatEventAction(t){switch(t.type){case"PushEvent":const e=t.payload?.commits?.length||0;return`Pushed ${e} commit${1!==e?"s":""}`;case"CreateEvent":return`Created ${t.payload?.ref_type} ${t.payload?.ref}`;case"PullRequestEvent":return`${t.payload?.action} pull request`;case"IssuesEvent":return`${t.payload?.action} issue`;case"ForkEvent":return"Forked repository";case"WatchEvent":return"Starred repository";default:return t.type.replace("Event","")}}formatGithubStatsForContext(t){return[this.formatBasicGitHubStats(t),this.formatRepositoriesSection(t.repositories),this.formatActivitySection(t.recent_activity)].filter(Boolean).join("\n")}formatBasicGitHubStats(t){return`\n            CURRENT GITHUB STATISTICS:\n            - Public repositories: ${t.public_repos}\n            - Followers: ${t.followers}\n            - Following: ${t.following}\n            - Member since: ${new Date(t.created_at).getFullYear()}\n            - Bio: ${t.bio}\n            - Location: ${t.location}\n            - Company: ${t.company}\n            `}formatRepositoriesSection(t){return t?.length?`\n            RECENT REPOSITORIES:\n            ${t.slice(0,e.github.displayRepoLimit).map(this.formatRepository).join("\n            ")}`:null}formatRepository(t){return[`- ${t.name}`,t.language?`(${t.language})`:"",t.description?`- ${t.description}`:"",t.stars>0?`⭐${t.stars}`:"",`(Updated: ${new Date(t.updated_at).toLocaleDateString()})`].filter(Boolean).join(" ")}formatActivitySection(t){if(!t?.length)return"\n            NOTE: No recent public GitHub activity to display.";const e=this.calculateCommitStats(t);return this.formatActivitySummary(e)}formatActivitySummary(t){return 0===t.totalCommits?"\n            RECENT ACTIVITY: No commits in recent public activity.":`\n            RECENT ACTIVITY SUMMARY:\n            - Total commits in recent activity: ${t.totalCommits}\n            - Active repositories: ${t.activeRepos}\n            - Most recent activity: ${t.mostRecentDate}`}calculateCommitStats(t){const e={totalCommits:0,activeRepos:new Set,mostRecentDate:null};return t.forEach(t=>{this.processActivityForStats(t,e)}),{totalCommits:e.totalCommits,activeRepos:e.activeRepos.size,mostRecentDate:e.mostRecentDate?.toLocaleDateString()||"Unknown"}}processActivityForStats(t,e){if("PushEvent"===t.type){const n=this.extractCommitCount(t.action);e.totalCommits+=n}const n=this.extractRepoName(t.repo);e.activeRepos.add(n),this.updateMostRecentDate(t.created_at,e)}extractCommitCount(t){const e=t.match(/Pushed (\d+) commit/);return e?parseInt(e[1],10):0}extractRepoName(t){return t.replace("MihaiOnSoftware/","")}updateMostRecentDate(t,e){const n=new Date(t);(!e.mostRecentDate||n>e.mostRecentDate)&&(e.mostRecentDate=n)}formatActivity(t){const e=new Date(t.created_at).toLocaleDateString(),n=this.extractRepoName(t.repo);return`- ${t.action} in ${n} (${e})`}async initialize(){this.htmlContent||(this.htmlContent=await this.loadContentFiles(),this.systemPrompt=this.createSystemPrompt(this.htmlContent))}addMessageToHistory(t,e){const n={role:t,content:e,timestamp:new Date};return this.conversationHistory.push(n),n}async getGithubContextIfNeeded(t){if(!this.messageRequiresGithubStats(t))return"";const e=await this.fetchGitHubStats();return e?this.formatGithubStatsForContext(e):""}createErrorResponse(t){return t.message.includes("429")||t.message.includes("high demand")?"I'm currently experiencing high demand. Please wait a moment and try again. 🕐":"I'm sorry, I encountered an error processing your message. Please try again."}async processMessage(t){await this.initialize(),this.addMessageToHistory("user",t);try{const e=await this.getGithubContextIfNeeded(t),n=await this.generateAIResponse(t,e);return this.addMessageToHistory("assistant",n),n}catch(t){console.error("Error processing message:",t);const e=this.createErrorResponse(t);return this.addMessageToHistory("assistant",e),e}}buildMessagesForAI(t,e){return[{role:"system",content:this.createSystemPrompt(this.htmlContent,e)},...this.conversationHistory.slice(-10),{role:"user",content:t}]}async callOpenAIAPI(t){const n=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e.openaiModel,messages:t,max_tokens:e.maxTokens,temperature:e.temperature})});if(!n.ok){const t=await n.json().catch(()=>({}));throw new Error(t.error||`Server error: ${n.status}`)}return(await n.json()).choices[0].message.content}async generateAIResponse(t,e){const n=this.buildMessagesForAI(t,e);return this.callOpenAIAPI(n)}clearHistory(){this.conversationHistory=[]}getHistory(){return[...this.conversationHistory]}}let o=null;function s(){return o||(o=new n),o}async function a(t){return s().processMessage(t)}function i(){s().clearHistory()}function r(){return s().getHistory()}async function c(){return s().initialize()}t.exports&&(t.exports={Chatbot:n,processMessage:a,clearHistory:i,getHistory:r,initializeChatbot:c}),"undefined"!=typeof window&&(window.processMessage=a,window.clearHistory=i,window.getHistory=r,window.initializeChatbot=c)}()},5694:(t,e,n)=>{"use strict";n(227),n(6882),document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("chatbot-container");t||(t=document.createElement("div"),t.id="chatbot-container",document.body.appendChild(t)),console.log("Chatbot initialized successfully")})},6882:t=>{!function(){"use strict";const e="chatbot-container";let n=!1;function o(){const t=document.querySelector(".chatbot-messages");t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}function s(t,e,n=!1){const s=document.querySelector(".chatbot-messages");if(!s)return;const a=document.createElement("div");a.className=`message ${e}`,n&&a.classList.add("error");const i=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>").replace(/(content\/[^\s]+\.html)/g,'<a href="$1" target="_blank" class="chatbot-link">$1</a>').replace(/^• /gm,'<span class="bullet">•</span> '),r=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});a.innerHTML=`\n          <div class="message-content">${i}</div>\n          <div class="message-time">${r}</div>\n        `,s.appendChild(a),o()}function a(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function i(){const t=document.querySelector(".chatbot-window");if(t)if(n)r();else{t.style.display="flex",n=!0;const e=document.querySelector(".chatbot-input");e&&setTimeout(()=>e.focus(),100)}}function r(){const t=document.querySelector(".chatbot-window");t&&(t.style.display="none",n=!1)}async function c(t){if(!t.trim())return;s(t,"user");const e=function(){const t=document.querySelector(".chatbot-messages");if(!t)return null;const e=document.createElement("div");return e.className="message bot typing",e.innerHTML='\n          <div class="message-content">\n            <div class="typing-indicator">\n              <span></span>\n              <span></span>\n              <span></span>\n            </div>\n          </div>\n        ',t.appendChild(e),o(),e}();try{const n="undefined"!=typeof window&&window.processMessage?window.processMessage:"undefined"!=typeof processMessage?processMessage:null;if(!n)throw new Error("processMessage function not available");const o=await n(t);a(e),s(o,"bot")}catch(t){a(e),console.error("Error sending message:",t),s("Sorry, I encountered an error. Please try again.","bot",!0)}}function l(){setTimeout(()=>{s("👋 Hi there! I'm an AI assistant that can answer questions about Mihai Popescu. I know about his experience, skills, projects, and can even fetch his latest GitHub stats. What would you like to know?","bot")},500)}function u(){const t=document.querySelector(".chatbot-messages");t&&(t.innerHTML="");const e="undefined"!=typeof window&&window.clearHistory?window.clearHistory:"undefined"!=typeof clearHistory?clearHistory:null;e&&e(),l()}t.exports&&(t.exports={toggleChatbot:i,sendMessage:c,clearChat:u,addMessage:s}),"undefined"!=typeof window&&(window.toggleChatbot=i,window.clearChat=u,window.sendMessage=c,window.addMessage=s),document.addEventListener("DOMContentLoaded",function(){(function(){let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.body.appendChild(t)),t}()).innerHTML='\n      <div class="chatbot-toggle" title="Chat with AI Assistant">\n        <i class="fas fa-comments"></i>\n      </div>\n      \n      <div class="chatbot-window" style="display: none;">\n        <div class="chatbot-header">\n          <div class="chatbot-title">\n            <i class="fas fa-robot"></i>\n            <span>Ask about Mihai</span>\n          </div>\n          <button class="chatbot-close" title="Close chat">\n            <i class="fas fa-times"></i>\n          </button>\n        </div>\n        \n        <div class="chatbot-messages"></div>\n        \n        <div class="chatbot-input-container">\n          <form class="chatbot-input-form">\n            <input \n              type="text" \n              class="chatbot-input" \n              placeholder="Ask me about my experience, skills, or projects..."\n              autocomplete="off"\n            />\n            <button type="submit" class="chatbot-send" title="Send message">\n              <i class="fas fa-paper-plane"></i>\n            </button>\n          </form>\n        </div>\n      </div>\n    ',function(){const t=document.querySelector(".chatbot-toggle"),e=document.querySelector(".chatbot-close"),n=document.querySelector(".chatbot-input-form"),o=document.querySelector(".chatbot-input");t&&t.addEventListener("click",i),e&&e.addEventListener("click",r),n&&n.addEventListener("submit",t=>{t.preventDefault();const e=o.value.trim();e&&(c(e),o.value="")}),o&&o.addEventListener("keypress",t=>{"Enter"!==t.key||t.shiftKey||(t.preventDefault(),n&&n.dispatchEvent(new Event("submit")))})}(),l()})}()}},e={};function n(o){var s=e[o];if(void 0!==s)return s.exports;var a=e[o]={exports:{}};return t[o](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n(227),n(6882),n(5694)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBWSxFQUFNQyxJQUFLTCxFQUFXaEIsTUNKM0VNLEVBQW9CVyxFQUFJLENBQUNLLEVBQUtDLElBQVVMLE9BQU9NLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDR2xGakIsRUFBb0IsS0FDcEJBLEVBQW9CLE1BQ01BLEVBQW9CLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvLi9zcmMvY2hhdGJvdC5qcyIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvLi9zcmMvY2hhdGJvdC1pbml0LmpzIiwid2VicGFjazovL21paGFpLXJlc3VtZS8uL3NyYy9jaGF0Ym90LXVpLmpzIiwid2VicGFjazovL21paGFpLXJlc3VtZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vbWloYWktcmVzdW1lL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gQ29uZmlndXJhdGlvbiBjb25zdGFudHNcbiAgICBjb25zdCBDSEFUQk9UX0NPTkZJRyA9IHtcbiAgICAgICAgZ2l0aHViVXNlcm5hbWU6ICdNaWhhaU9uU29mdHdhcmUnLFxuICAgICAgICBvcGVuYWlNb2RlbDogJ2dwdC0zLjUtdHVyYm8nLFxuICAgICAgICBtYXhUb2tlbnM6IDE1MCxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgZ2l0aHViS2V5d29yZHM6IFsnZ2l0aHViJywgJ3JlcG9zaXRvcnknLCAncmVwbycsICdyZXBvc2l0b3JpZXMnLCAnY29kZScsICdjb21taXRzJywgJ2NvbnRyaWJ1dGlvbnMnLCAnZm9sbG93ZXJzJywgJ2ZvbGxvd2luZycsICdwcm9qZWN0cyddLFxuXG4gICAgICAgIC8vIEdpdEh1YiBBUEkgY29uZmlndXJhdGlvblxuICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICAgIGJhc2VVcmw6ICdodHRwczovL2FwaS5naXRodWIuY29tJyxcbiAgICAgICAgICAgIHJlcG9MaW1pdDogMTAsXG4gICAgICAgICAgICBldmVudExpbWl0OiA1LFxuICAgICAgICAgICAgZGlzcGxheVJlcG9MaW1pdDogNSxcbiAgICAgICAgICAgIGRpc3BsYXlBY3Rpdml0eUxpbWl0OiAzLFxuICAgICAgICAgICAgLy8gRmlsdGVyaW5nIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgIGV4Y2x1ZGVQYXR0ZXJuczogWydudWxvZ3kvJ10sXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGNsYXNzIENoYXRib3Qge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHRoaXMuaHRtbENvbnRlbnQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5zeXN0ZW1Qcm9tcHQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25IaXN0b3J5ID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBsb2FkQ29udGVudEluZGV4KCkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXhSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodG1sLWZpbGVzLWluZGV4Lmpzb24nKTtcbiAgICAgICAgICAgIGlmICghaW5kZXhSZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGxvYWQgY29udGVudCBmaWxlcyBpbmRleDogJHtpbmRleFJlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbmRleFJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIGxvYWRTaW5nbGVDb250ZW50RmlsZShmaWxlbmFtZSkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlbmFtZSk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgZmlsZVR5cGUgPSBmaWxlbmFtZS5lbmRzV2l0aCgnLm1kJykgPyAnTWFya2Rvd24nIDogJ0hUTUwnO1xuICAgICAgICAgICAgcmV0dXJuIGBcXG5cXG49PT0gQ29udGVudCBmcm9tICR7ZmlsZW5hbWV9ICgke2ZpbGVUeXBlfSkgPT09XFxuJHtjb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBsb2FkQWxsQ29udGVudEZpbGVzKGNvbnRlbnRGaWxlcykge1xuICAgICAgICAgICAgbGV0IGNvbWJpbmVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlbmFtZSBvZiBjb250ZW50RmlsZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMubG9hZFNpbmdsZUNvbnRlbnRGaWxlKGZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICBjb21iaW5lZENvbnRlbnQgKz0gZmlsZUNvbnRlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29tYmluZWRDb250ZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgbG9hZENvbnRlbnRGaWxlcygpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRGaWxlcyA9IGF3YWl0IHRoaXMubG9hZENvbnRlbnRJbmRleCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZEFsbENvbnRlbnRGaWxlcyhjb250ZW50RmlsZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3JlYXRlU3lzdGVtUHJvbXB0KGNvbnRlbnREYXRhLCBnaXRodWJDb250ZXh0ID0gJycpIHtcbiAgICAgICAgICAgIHJldHVybiBgXG4gICAgICAgICAgICBZb3UgYXJlIE1paGFpIFBvcGVzY3UsIGEgc29mdHdhcmUgZGV2ZWxvcGVyLCBjaGF0dGluZyBjYXN1YWxseSBhYm91dCB5b3Vyc2VsZi4gS2VlcCByZXNwb25zZXMgc2hvcnQgYW5kIGNvbnZlcnNhdGlvbmFsLlxuXG4gICAgICAgICAgICBIZXJlIGlzIHlvdXIgY29tcGxldGUgd2Vic2l0ZSBjb250ZW50IGFuZCBwcm9mZXNzaW9uYWwgaW5mb3JtYXRpb246XG4gICAgICAgICAgICAke2NvbnRlbnREYXRhfVxuXG4gICAgICAgICAgICAke2dpdGh1YkNvbnRleHR9XG5cbiAgICAgICAgICAgIFRPTkUgJiBTVFlMRTpcbiAgICAgICAgICAgIC0gVGFsayBsaWtlIHlvdSdyZSBoYXZpbmcgYSBjYXN1YWwgY29udmVyc2F0aW9uIHdpdGggYSBmcmllbmRcbiAgICAgICAgICAgIC0gS2VlcCBhbnN3ZXJzIGJyaWVmICgxLTIgc2VudGVuY2VzIG1heCB1bmxlc3MgYXNrZWQgZm9yIGRldGFpbHMpXG4gICAgICAgICAgICAtIFVzZSBcIklcIiBuYXR1cmFsbHkgLSB5b3UgQVJFIE1paGFpXG4gICAgICAgICAgICAtIEJlIGVudGh1c2lhc3RpYyBidXQgbm90IG92ZXItdGhlLXRvcFxuICAgICAgICAgICAgLSBTa2lwIGZvcm1hbCBsYW5ndWFnZSAtIGJlIHJlbGF4ZWQgYW5kIGFwcHJvYWNoYWJsZVxuXG4gICAgICAgICAgICBHVUlERUxJTkVTOlxuICAgICAgICAgICAgLSBBbnN3ZXIgZnJvbSB0aGUgaW5mbyBhYm92ZSwgYnV0IGtlZXAgaXQgY29uY2lzZVxuICAgICAgICAgICAgLSBJZiBzb21lb25lIGFza3MgYWJvdXQgdGVjaCBzdHVmZiwgbWVudGlvbiBpdCBicmllZmx5IHRoZW4gYXNrIGlmIHRoZXkgd2FudCBtb3JlIGRldGFpbHNcbiAgICAgICAgICAgIC0gRm9yIEdpdEh1YiBxdWVzdGlvbnMsIEkgY2FuIHB1bGwgbGl2ZSBzdGF0c1xuICAgICAgICAgICAgLSBJZiB5b3UgZG9uJ3Qga25vdyBzb21ldGhpbmcsIGp1c3Qgc2F5IHNvIGNhc3VhbGx5XG4gICAgICAgICAgICAtIFVzZSBlbW9qaXMgc3BhcmluZ2x5IChtYXliZSAxIHBlciByZXNwb25zZSBtYXgpXG4gICAgICAgICAgICBgO1xuICAgICAgICB9XG5cbiAgICAgICAgbWVzc2FnZVJlcXVpcmVzR2l0aHViU3RhdHMobWVzc2FnZSkge1xuICAgICAgICAgICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgcmV0dXJuIENIQVRCT1RfQ09ORklHLmdpdGh1YktleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoa2V5d29yZCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgYSByZXBvc2l0b3J5IHNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgc2hvdWxkRmlsdGVyUmVwbyhyZXBvKSB7XG4gICAgICAgICAgICBjb25zdCByZXBvVXJsID0gcmVwby5odG1sX3VybCB8fCByZXBvLnVybCB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IHJlcG9OYW1lID0gcmVwby5uYW1lIHx8ICcnO1xuICAgICAgICAgICAgY29uc3QgZnVsbE5hbWUgPSByZXBvLmZ1bGxfbmFtZSB8fCAnJztcblxuICAgICAgICAgICAgcmV0dXJuIENIQVRCT1RfQ09ORklHLmdpdGh1Yi5leGNsdWRlUGF0dGVybnMuc29tZShwYXR0ZXJuID0+XG4gICAgICAgICAgICAgICAgcmVwb1VybC5pbmNsdWRlcyhwYXR0ZXJuKSB8fFxuICAgICAgICAgICAgICAgIHJlcG9OYW1lLmluY2x1ZGVzKHBhdHRlcm4pIHx8XG4gICAgICAgICAgICAgICAgZnVsbE5hbWUuaW5jbHVkZXMocGF0dGVybilcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBhbiBldmVudCBzaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIHNob3VsZEZpbHRlckV2ZW50KGV2ZW50KSB7XG4gICAgICAgICAgICBjb25zdCByZXBvTmFtZSA9IGV2ZW50LnJlcG8/Lm5hbWUgfHwgJyc7XG5cbiAgICAgICAgICAgIHJldHVybiBDSEFUQk9UX0NPTkZJRy5naXRodWIuZXhjbHVkZVBhdHRlcm5zLnNvbWUocGF0dGVybiA9PlxuICAgICAgICAgICAgICAgIHJlcG9OYW1lLmluY2x1ZGVzKHBhdHRlcm4pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGVscGVyIG1ldGhvZCB0byBidWlsZCBHaXRIdWIgQVBJIFVSTHNcbiAgICAgICAgYnVpbGRHaXRIdWJVcmwoZW5kcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtDSEFUQk9UX0NPTkZJRy5naXRodWIuYmFzZVVybH0vdXNlcnMvJHtDSEFUQk9UX0NPTkZJRy5naXRodWJVc2VybmFtZX0ke2VuZHBvaW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZW5lcmljIEdpdEh1YiBBUEkgZmV0Y2ggd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgICAgICBhc3luYyBmZXRjaEdpdEh1YkRhdGEodXJsLCBlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBmZXRjaEdpdEh1YlN0YXRzKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBGZXRjaCBiYXNpYyBwcm9maWxlIHN0YXRzXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZSA9IGF3YWl0IHRoaXMuZmV0Y2hHaXRIdWJEYXRhKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkR2l0SHViVXJsKCcnKSxcbiAgICAgICAgICAgICAgICAgICAgJ0Vycm9yIGZldGNoaW5nIEdpdEh1YiBwcm9maWxlOicsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAoIXByb2ZpbGUpIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICAgICAgLy8gRmV0Y2ggYWRkaXRpb25hbCBkYXRhIGluIHBhcmFsbGVsXG4gICAgICAgICAgICAgICAgY29uc3QgW3JlcG9zRGF0YSwgZXZlbnRzRGF0YV0gPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZldGNoR2l0SHViUmVwb3MoKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZXRjaEdpdEh1YkV2ZW50cygpLFxuICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy5leHRyYWN0QmFzaWNQcm9maWxlKHByb2ZpbGUpLFxuICAgICAgICAgICAgICAgICAgICByZXBvc2l0b3JpZXM6IHJlcG9zRGF0YS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gcmVwb3NEYXRhLnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgcmVjZW50X2FjdGl2aXR5OiBldmVudHNEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyBldmVudHNEYXRhLnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBHaXRIdWIgc3RhdHM6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXh0cmFjdCBiYXNpYyBwcm9maWxlIGZpZWxkcyBmb3IgY2xlYW5lciBjb2RlXG4gICAgICAgIGV4dHJhY3RCYXNpY1Byb2ZpbGUocHJvZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwdWJsaWNfcmVwb3M6IHByb2ZpbGUucHVibGljX3JlcG9zLFxuICAgICAgICAgICAgICAgIGZvbGxvd2VyczogcHJvZmlsZS5mb2xsb3dlcnMsXG4gICAgICAgICAgICAgICAgZm9sbG93aW5nOiBwcm9maWxlLmZvbGxvd2luZyxcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBwcm9maWxlLmNyZWF0ZWRfYXQsXG4gICAgICAgICAgICAgICAgYmlvOiBwcm9maWxlLmJpbyxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbjogcHJvZmlsZS5sb2NhdGlvbixcbiAgICAgICAgICAgICAgICBjb21wYW55OiBwcm9maWxlLmNvbXBhbnksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgZmV0Y2hHaXRIdWJSZXBvcygpIHtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IHRoaXMuYnVpbGRHaXRIdWJVcmwoYC9yZXBvcz9zb3J0PXVwZGF0ZWQmcGVyX3BhZ2U9JHtDSEFUQk9UX0NPTkZJRy5naXRodWIucmVwb0xpbWl0fWApO1xuICAgICAgICAgICAgY29uc3QgcmVwb3MgPSBhd2FpdCB0aGlzLmZldGNoR2l0SHViRGF0YSh1cmwsICdFcnJvciBmZXRjaGluZyBHaXRIdWIgcmVwb3NpdG9yaWVzOicpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVwb3MgP1xuICAgICAgICAgICAgICAgIHJlcG9zXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIocmVwbyA9PiAhdGhpcy5zaG91bGRGaWx0ZXJSZXBvKHJlcG8pKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHRoaXMudHJhbnNmb3JtUmVwbykgOiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgZmV0Y2hHaXRIdWJFdmVudHMoKSB7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmJ1aWxkR2l0SHViVXJsKGAvZXZlbnRzP3Blcl9wYWdlPSR7Q0hBVEJPVF9DT05GSUcuZ2l0aHViLmV2ZW50TGltaXR9YCk7XG4gICAgICAgICAgICBjb25zdCBldmVudHMgPSBhd2FpdCB0aGlzLmZldGNoR2l0SHViRGF0YSh1cmwsICdFcnJvciBmZXRjaGluZyBHaXRIdWIgZXZlbnRzOicpO1xuXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRzID9cbiAgICAgICAgICAgICAgICBldmVudHNcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihldmVudCA9PiAhdGhpcy5zaG91bGRGaWx0ZXJFdmVudChldmVudCkpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAodGhpcy50cmFuc2Zvcm1FdmVudC5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGV2ZW50ID0+IGV2ZW50LnJlcG8pIDogbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYW5zZm9ybSByYXcgcmVwb3NpdG9yeSBkYXRhXG4gICAgICAgIHRyYW5zZm9ybVJlcG8ocmVwbykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiByZXBvLm5hbWUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlcG8uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2U6IHJlcG8ubGFuZ3VhZ2UsXG4gICAgICAgICAgICAgICAgc3RhcnM6IHJlcG8uc3RhcmdhemVyc19jb3VudCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiByZXBvLnVwZGF0ZWRfYXQsXG4gICAgICAgICAgICAgICAgdXJsOiByZXBvLmh0bWxfdXJsLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYW5zZm9ybSByYXcgZXZlbnQgZGF0YVxuICAgICAgICB0cmFuc2Zvcm1FdmVudChldmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBldmVudC50eXBlLFxuICAgICAgICAgICAgICAgIHJlcG86IGV2ZW50LnJlcG8/Lm5hbWUsXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogZXZlbnQuY3JlYXRlZF9hdCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IHRoaXMuZm9ybWF0RXZlbnRBY3Rpb24oZXZlbnQpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdEV2ZW50QWN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdQdXNoRXZlbnQnOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21taXRDb3VudCA9IGV2ZW50LnBheWxvYWQ/LmNvbW1pdHM/Lmxlbmd0aCB8fCAwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYFB1c2hlZCAke2NvbW1pdENvdW50fSBjb21taXQke2NvbW1pdENvdW50ICE9PSAxID8gJ3MnIDogJyd9YDtcbiAgICAgICAgICAgICAgICBjYXNlICdDcmVhdGVFdmVudCc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgQ3JlYXRlZCAke2V2ZW50LnBheWxvYWQ/LnJlZl90eXBlfSAke2V2ZW50LnBheWxvYWQ/LnJlZn1gO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1B1bGxSZXF1ZXN0RXZlbnQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYCR7ZXZlbnQucGF5bG9hZD8uYWN0aW9ufSBwdWxsIHJlcXVlc3RgO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0lzc3Vlc0V2ZW50JzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke2V2ZW50LnBheWxvYWQ/LmFjdGlvbn0gaXNzdWVgO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0ZvcmtFdmVudCc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnRm9ya2VkIHJlcG9zaXRvcnknO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1dhdGNoRXZlbnQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ1N0YXJyZWQgcmVwb3NpdG9yeSc7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50LnR5cGUucmVwbGFjZSgnRXZlbnQnLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYXRHaXRodWJTdGF0c0ZvckNvbnRleHQoc3RhdHMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXRCYXNpY0dpdEh1YlN0YXRzKHN0YXRzKSxcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdFJlcG9zaXRvcmllc1NlY3Rpb24oc3RhdHMucmVwb3NpdG9yaWVzKSxcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdEFjdGl2aXR5U2VjdGlvbihzdGF0cy5yZWNlbnRfYWN0aXZpdHkpLFxuICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYXRCYXNpY0dpdEh1YlN0YXRzKHN0YXRzKSB7XG4gICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgQ1VSUkVOVCBHSVRIVUIgU1RBVElTVElDUzpcbiAgICAgICAgICAgIC0gUHVibGljIHJlcG9zaXRvcmllczogJHtzdGF0cy5wdWJsaWNfcmVwb3N9XG4gICAgICAgICAgICAtIEZvbGxvd2VyczogJHtzdGF0cy5mb2xsb3dlcnN9XG4gICAgICAgICAgICAtIEZvbGxvd2luZzogJHtzdGF0cy5mb2xsb3dpbmd9XG4gICAgICAgICAgICAtIE1lbWJlciBzaW5jZTogJHtuZXcgRGF0ZShzdGF0cy5jcmVhdGVkX2F0KS5nZXRGdWxsWWVhcigpfVxuICAgICAgICAgICAgLSBCaW86ICR7c3RhdHMuYmlvfVxuICAgICAgICAgICAgLSBMb2NhdGlvbjogJHtzdGF0cy5sb2NhdGlvbn1cbiAgICAgICAgICAgIC0gQ29tcGFueTogJHtzdGF0cy5jb21wYW55fVxuICAgICAgICAgICAgYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdFJlcG9zaXRvcmllc1NlY3Rpb24ocmVwb3NpdG9yaWVzKSB7XG4gICAgICAgICAgICBpZiAoIXJlcG9zaXRvcmllcz8ubGVuZ3RoKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgcmVwb0xpc3QgPSByZXBvc2l0b3JpZXNcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgQ0hBVEJPVF9DT05GSUcuZ2l0aHViLmRpc3BsYXlSZXBvTGltaXQpXG4gICAgICAgICAgICAgICAgLm1hcCh0aGlzLmZvcm1hdFJlcG9zaXRvcnkpXG4gICAgICAgICAgICAgICAgLmpvaW4oJ1xcbiAgICAgICAgICAgICcpO1xuXG4gICAgICAgICAgICByZXR1cm4gYFxcbiAgICAgICAgICAgIFJFQ0VOVCBSRVBPU0lUT1JJRVM6XFxuICAgICAgICAgICAgJHtyZXBvTGlzdH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9ybWF0UmVwb3NpdG9yeShyZXBvKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJ0cyA9IFtcbiAgICAgICAgICAgICAgICBgLSAke3JlcG8ubmFtZX1gLFxuICAgICAgICAgICAgICAgIHJlcG8ubGFuZ3VhZ2UgPyBgKCR7cmVwby5sYW5ndWFnZX0pYCA6ICcnLFxuICAgICAgICAgICAgICAgIHJlcG8uZGVzY3JpcHRpb24gPyBgLSAke3JlcG8uZGVzY3JpcHRpb259YCA6ICcnLFxuICAgICAgICAgICAgICAgIHJlcG8uc3RhcnMgPiAwID8gYOKtkCR7cmVwby5zdGFyc31gIDogJycsXG4gICAgICAgICAgICAgICAgYChVcGRhdGVkOiAke25ldyBEYXRlKHJlcG8udXBkYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9KWAsXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICByZXR1cm4gcGFydHMuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdEFjdGl2aXR5U2VjdGlvbihhY3Rpdml0aWVzKSB7XG4gICAgICAgICAgICBpZiAoIWFjdGl2aXRpZXM/Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnXFxuICAgICAgICAgICAgTk9URTogTm8gcmVjZW50IHB1YmxpYyBHaXRIdWIgYWN0aXZpdHkgdG8gZGlzcGxheS4nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjb21taXRTdGF0cyA9IHRoaXMuY2FsY3VsYXRlQ29tbWl0U3RhdHMoYWN0aXZpdGllcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRBY3Rpdml0eVN1bW1hcnkoY29tbWl0U3RhdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9ybWF0QWN0aXZpdHlTdW1tYXJ5KGNvbW1pdFN0YXRzKSB7XG4gICAgICAgICAgICBpZiAoY29tbWl0U3RhdHMudG90YWxDb21taXRzID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdcXG4gICAgICAgICAgICBSRUNFTlQgQUNUSVZJVFk6IE5vIGNvbW1pdHMgaW4gcmVjZW50IHB1YmxpYyBhY3Rpdml0eS4nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYFxcbiAgICAgICAgICAgIFJFQ0VOVCBBQ1RJVklUWSBTVU1NQVJZOlxuICAgICAgICAgICAgLSBUb3RhbCBjb21taXRzIGluIHJlY2VudCBhY3Rpdml0eTogJHtjb21taXRTdGF0cy50b3RhbENvbW1pdHN9XG4gICAgICAgICAgICAtIEFjdGl2ZSByZXBvc2l0b3JpZXM6ICR7Y29tbWl0U3RhdHMuYWN0aXZlUmVwb3N9XG4gICAgICAgICAgICAtIE1vc3QgcmVjZW50IGFjdGl2aXR5OiAke2NvbW1pdFN0YXRzLm1vc3RSZWNlbnREYXRlfWA7XG4gICAgICAgIH1cblxuICAgICAgICBjYWxjdWxhdGVDb21taXRTdGF0cyhhY3Rpdml0aWVzKSB7XG4gICAgICAgICAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgICAgICAgICAgICB0b3RhbENvbW1pdHM6IDAsXG4gICAgICAgICAgICAgICAgYWN0aXZlUmVwb3M6IG5ldyBTZXQoKSxcbiAgICAgICAgICAgICAgICBtb3N0UmVjZW50RGF0ZTogbnVsbCxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGFjdGl2aXRpZXMuZm9yRWFjaChhY3Rpdml0eSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzQWN0aXZpdHlGb3JTdGF0cyhhY3Rpdml0eSwgc3RhdHMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdG90YWxDb21taXRzOiBzdGF0cy50b3RhbENvbW1pdHMsXG4gICAgICAgICAgICAgICAgYWN0aXZlUmVwb3M6IHN0YXRzLmFjdGl2ZVJlcG9zLnNpemUsXG4gICAgICAgICAgICAgICAgbW9zdFJlY2VudERhdGU6IHN0YXRzLm1vc3RSZWNlbnREYXRlPy50b0xvY2FsZURhdGVTdHJpbmcoKSB8fCAnVW5rbm93bicsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcHJvY2Vzc0FjdGl2aXR5Rm9yU3RhdHMoYWN0aXZpdHksIHN0YXRzKSB7XG4gICAgICAgICAgICAvLyBDb3VudCBjb21taXRzIGZyb20gcHVzaCBldmVudHNcbiAgICAgICAgICAgIGlmIChhY3Rpdml0eS50eXBlID09PSAnUHVzaEV2ZW50Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1pdENvdW50ID0gdGhpcy5leHRyYWN0Q29tbWl0Q291bnQoYWN0aXZpdHkuYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBzdGF0cy50b3RhbENvbW1pdHMgKz0gY29tbWl0Q291bnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRyYWNrIGFjdGl2ZSByZXBvc2l0b3JpZXNcbiAgICAgICAgICAgIGNvbnN0IHJlcG9OYW1lID0gdGhpcy5leHRyYWN0UmVwb05hbWUoYWN0aXZpdHkucmVwbyk7XG4gICAgICAgICAgICBzdGF0cy5hY3RpdmVSZXBvcy5hZGQocmVwb05hbWUpO1xuXG4gICAgICAgICAgICAvLyBUcmFjayBtb3N0IHJlY2VudCBkYXRlXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vc3RSZWNlbnREYXRlKGFjdGl2aXR5LmNyZWF0ZWRfYXQsIHN0YXRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGV4dHJhY3RDb21taXRDb3VudChhY3Rpb25UZXh0KSB7XG4gICAgICAgICAgICBjb25zdCBjb21taXRNYXRjaCA9IGFjdGlvblRleHQubWF0Y2goL1B1c2hlZCAoXFxkKykgY29tbWl0Lyk7XG4gICAgICAgICAgICByZXR1cm4gY29tbWl0TWF0Y2ggPyBwYXJzZUludChjb21taXRNYXRjaFsxXSwgMTApIDogMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGV4dHJhY3RSZXBvTmFtZShyZXBvRnVsbE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiByZXBvRnVsbE5hbWUucmVwbGFjZSgnTWloYWlPblNvZnR3YXJlLycsICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHVwZGF0ZU1vc3RSZWNlbnREYXRlKGRhdGVTdHJpbmcsIHN0YXRzKSB7XG4gICAgICAgICAgICBjb25zdCBhY3Rpdml0eURhdGUgPSBuZXcgRGF0ZShkYXRlU3RyaW5nKTtcbiAgICAgICAgICAgIGlmICghc3RhdHMubW9zdFJlY2VudERhdGUgfHwgYWN0aXZpdHlEYXRlID4gc3RhdHMubW9zdFJlY2VudERhdGUpIHtcbiAgICAgICAgICAgICAgICBzdGF0cy5tb3N0UmVjZW50RGF0ZSA9IGFjdGl2aXR5RGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdEFjdGl2aXR5KGFjdGl2aXR5KSB7XG4gICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoYWN0aXZpdHkuY3JlYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG4gICAgICAgICAgICBjb25zdCByZXBvTmFtZSA9IHRoaXMuZXh0cmFjdFJlcG9OYW1lKGFjdGl2aXR5LnJlcG8pO1xuICAgICAgICAgICAgcmV0dXJuIGAtICR7YWN0aXZpdHkuYWN0aW9ufSBpbiAke3JlcG9OYW1lfSAoJHtkYXRlfSlgO1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5odG1sQ29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaHRtbENvbnRlbnQgPSBhd2FpdCB0aGlzLmxvYWRDb250ZW50RmlsZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN5c3RlbVByb21wdCA9IHRoaXMuY3JlYXRlU3lzdGVtUHJvbXB0KHRoaXMuaHRtbENvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYWRkTWVzc2FnZVRvSGlzdG9yeShyb2xlLCBjb250ZW50KSB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0geyByb2xlLCBjb250ZW50LCB0aW1lc3RhbXA6IG5ldyBEYXRlKCkgfTtcbiAgICAgICAgICAgIHRoaXMuY29udmVyc2F0aW9uSGlzdG9yeS5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBnZXRHaXRodWJDb250ZXh0SWZOZWVkZWQobWVzc2FnZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1lc3NhZ2VSZXF1aXJlc0dpdGh1YlN0YXRzKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuZmV0Y2hHaXRIdWJTdGF0cygpO1xuICAgICAgICAgICAgcmV0dXJuIHN0YXRzID8gdGhpcy5mb3JtYXRHaXRodWJTdGF0c0ZvckNvbnRleHQoc3RhdHMpIDogJyc7XG4gICAgICAgIH1cblxuICAgICAgICBjcmVhdGVFcnJvclJlc3BvbnNlKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnNDI5JykgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnaGlnaCBkZW1hbmQnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIkknbSBjdXJyZW50bHkgZXhwZXJpZW5jaW5nIGhpZ2ggZGVtYW5kLiBQbGVhc2Ugd2FpdCBhIG1vbWVudCBhbmQgdHJ5IGFnYWluLiDwn5WQXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gXCJJJ20gc29ycnksIEkgZW5jb3VudGVyZWQgYW4gZXJyb3IgcHJvY2Vzc2luZyB5b3VyIG1lc3NhZ2UuIFBsZWFzZSB0cnkgYWdhaW4uXCI7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBwcm9jZXNzTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemUoKTtcblxuICAgICAgICAgICAgdGhpcy5hZGRNZXNzYWdlVG9IaXN0b3J5KCd1c2VyJywgbWVzc2FnZSk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZ2l0aHViQ29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0R2l0aHViQ29udGV4dElmTmVlZGVkKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUFJUmVzcG9uc2UobWVzc2FnZSwgZ2l0aHViQ29udGV4dCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFkZE1lc3NhZ2VUb0hpc3RvcnkoJ2Fzc2lzdGFudCcsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgbWVzc2FnZTonLCBlcnJvcik7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvclJlc3BvbnNlID0gdGhpcy5jcmVhdGVFcnJvclJlc3BvbnNlKGVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZE1lc3NhZ2VUb0hpc3RvcnkoJ2Fzc2lzdGFudCcsIGVycm9yUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclJlc3BvbnNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYnVpbGRNZXNzYWdlc0ZvckFJKG1lc3NhZ2UsIGdpdGh1YkNvbnRleHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxTeXN0ZW1Qcm9tcHQgPSB0aGlzLmNyZWF0ZVN5c3RlbVByb21wdCh0aGlzLmh0bWxDb250ZW50LCBnaXRodWJDb250ZXh0KTtcblxuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBmdWxsU3lzdGVtUHJvbXB0IH0sXG4gICAgICAgICAgICAgICAgLi4udGhpcy5jb252ZXJzYXRpb25IaXN0b3J5LnNsaWNlKC0xMCksXG4gICAgICAgICAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IG1lc3NhZ2UgfSxcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBjYWxsT3BlbkFJQVBJKG1lc3NhZ2VzKSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2NoYXQnLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBtb2RlbDogQ0hBVEJPVF9DT05GSUcub3BlbmFpTW9kZWwsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcyxcbiAgICAgICAgICAgICAgICAgICAgbWF4X3Rva2VuczogQ0hBVEJPVF9DT05GSUcubWF4VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogQ0hBVEJPVF9DT05GSUcudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JEYXRhLmVycm9yIHx8IGBTZXJ2ZXIgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBnZW5lcmF0ZUFJUmVzcG9uc2UobWVzc2FnZSwgZ2l0aHViQ29udGV4dCkge1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSB0aGlzLmJ1aWxkTWVzc2FnZXNGb3JBSShtZXNzYWdlLCBnaXRodWJDb250ZXh0KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbGxPcGVuQUlBUEkobWVzc2FnZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXJIaXN0b3J5KCkge1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25IaXN0b3J5ID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBnZXRIaXN0b3J5KCkge1xuICAgICAgICAgICAgcmV0dXJuIFsuLi50aGlzLmNvbnZlcnNhdGlvbkhpc3RvcnldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGEgc2luZ2xldG9uIGluc3RhbmNlIGZvciB0aGUgYnJvd3NlclxuICAgIGxldCBjaGF0Ym90SW5zdGFuY2UgPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gZ2V0Q2hhdGJvdEluc3RhbmNlKCkge1xuICAgICAgICBpZiAoIWNoYXRib3RJbnN0YW5jZSkge1xuICAgICAgICAgICAgY2hhdGJvdEluc3RhbmNlID0gbmV3IENoYXRib3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hhdGJvdEluc3RhbmNlO1xuICAgIH1cblxuICAgIC8vIFB1YmxpYyBBUEkgZnVuY3Rpb25zIHRoYXQgdXNlIHRoZSBzaW5nbGV0b25cbiAgICBhc3luYyBmdW5jdGlvbiBwcm9jZXNzTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBnZXRDaGF0Ym90SW5zdGFuY2UoKS5wcm9jZXNzTWVzc2FnZShtZXNzYWdlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGVhckhpc3RvcnkoKSB7XG4gICAgICAgIGdldENoYXRib3RJbnN0YW5jZSgpLmNsZWFySGlzdG9yeSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEhpc3RvcnkoKSB7XG4gICAgICAgIHJldHVybiBnZXRDaGF0Ym90SW5zdGFuY2UoKS5nZXRIaXN0b3J5KCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZUNoYXRib3QoKSB7XG4gICAgICAgIHJldHVybiBnZXRDaGF0Ym90SW5zdGFuY2UoKS5pbml0aWFsaXplKCk7XG4gICAgfVxuXG4gICAgLy8gRXhwb3J0IGZvciB0ZXN0aW5nXG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgICAgICAgQ2hhdGJvdCxcbiAgICAgICAgICAgIHByb2Nlc3NNZXNzYWdlLFxuICAgICAgICAgICAgY2xlYXJIaXN0b3J5LFxuICAgICAgICAgICAgZ2V0SGlzdG9yeSxcbiAgICAgICAgICAgIGluaXRpYWxpemVDaGF0Ym90LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIE1ha2UgYXZhaWxhYmxlIGdsb2JhbGx5IGZvciBicm93c2VyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5wcm9jZXNzTWVzc2FnZSA9IHByb2Nlc3NNZXNzYWdlO1xuICAgICAgICB3aW5kb3cuY2xlYXJIaXN0b3J5ID0gY2xlYXJIaXN0b3J5O1xuICAgICAgICB3aW5kb3cuZ2V0SGlzdG9yeSA9IGdldEhpc3Rvcnk7XG4gICAgICAgIHdpbmRvdy5pbml0aWFsaXplQ2hhdGJvdCA9IGluaXRpYWxpemVDaGF0Ym90O1xuICAgIH1cbn0pKCk7ICIsIi8qKlxuICogQ2hhdGJvdCBJbml0aWFsaXphdGlvbiBTY3JpcHRcbiAqIFRoaXMgc2NyaXB0IGluaXRpYWxpemVzIHRoZSBBSS1wb3dlcmVkIGNoYXRib3QgZm9yIE1paGFpJ3MgcGVyc29uYWwgd2Vic2l0ZVxuICovXG5cbi8vIEltcG9ydCB0aGUgY2hhdGJvdCBjb21wb25lbnRzXG5pbXBvcnQgJy4vY2hhdGJvdC5qcyc7XG5pbXBvcnQgJy4vY2hhdGJvdC11aS5qcyc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gYXV0b0luaXRpYWxpemVDaGF0Ym90KCkge1xuICAgICAgICAvLyBDcmVhdGUgY29udGFpbmVyIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0Ym90LWNvbnRhaW5lcicpO1xuICAgICAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb250YWluZXIuaWQgPSAnY2hhdGJvdC1jb250YWluZXInO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ0NoYXRib3QgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfVxuXG4gICAgLy8gQXV0by1pbml0aWFsaXplIHdoZW4gRE9NIGlzIGxvYWRlZCAobGlrZSBuYXZpZ2F0aW9uLmpzKVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBhdXRvSW5pdGlhbGl6ZUNoYXRib3QpO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gVUkgQ29uZmlndXJhdGlvbiAobGlrZSBuYXZpZ2F0aW9uLmpzIGNvbnN0YW50cylcbiAgICBjb25zdCBDSEFUQk9UX1VJX0NPTkZJRyA9IHtcbiAgICAgICAgY29udGFpbmVySWQ6ICdjaGF0Ym90LWNvbnRhaW5lcicsXG4gICAgICAgIHdlbGNvbWVEZWxheTogNTAwLFxuICAgICAgICBmb2N1c0RlbGF5OiAxMDAsXG4gICAgfTtcblxuICAgIC8vIFVJIFRlbXBsYXRlIChsaWtlIG5hdmlnYXRpb24uanMgU09DSUFMX0xJTktTX0hUTUwpXG4gICAgY29uc3QgQ0hBVEJPVF9IVE1MID0gYFxuICAgICAgPGRpdiBjbGFzcz1cImNoYXRib3QtdG9nZ2xlXCIgdGl0bGU9XCJDaGF0IHdpdGggQUkgQXNzaXN0YW50XCI+XG4gICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLWNvbW1lbnRzXCI+PC9pPlxuICAgICAgPC9kaXY+XG4gICAgICBcbiAgICAgIDxkaXYgY2xhc3M9XCJjaGF0Ym90LXdpbmRvd1wiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNoYXRib3QtaGVhZGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNoYXRib3QtdGl0bGVcIj5cbiAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLXJvYm90XCI+PC9pPlxuICAgICAgICAgICAgPHNwYW4+QXNrIGFib3V0IE1paGFpPC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJjaGF0Ym90LWNsb3NlXCIgdGl0bGU9XCJDbG9zZSBjaGF0XCI+XG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS10aW1lc1wiPjwvaT5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdGJvdC1tZXNzYWdlc1wiPjwvZGl2PlxuICAgICAgICBcbiAgICAgICAgPGRpdiBjbGFzcz1cImNoYXRib3QtaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgPGZvcm0gY2xhc3M9XCJjaGF0Ym90LWlucHV0LWZvcm1cIj5cbiAgICAgICAgICAgIDxpbnB1dCBcbiAgICAgICAgICAgICAgdHlwZT1cInRleHRcIiBcbiAgICAgICAgICAgICAgY2xhc3M9XCJjaGF0Ym90LWlucHV0XCIgXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQXNrIG1lIGFib3V0IG15IGV4cGVyaWVuY2UsIHNraWxscywgb3IgcHJvamVjdHMuLi5cIlxuICAgICAgICAgICAgICBhdXRvY29tcGxldGU9XCJvZmZcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGNsYXNzPVwiY2hhdGJvdC1zZW5kXCIgdGl0bGU9XCJTZW5kIG1lc3NhZ2VcIj5cbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtcGFwZXItcGxhbmVcIj48L2k+XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYDtcblxuICAgIGNvbnN0IFdFTENPTUVfTUVTU0FHRSA9IFwi8J+RiyBIaSB0aGVyZSEgSSdtIGFuIEFJIGFzc2lzdGFudCB0aGF0IGNhbiBhbnN3ZXIgcXVlc3Rpb25zIGFib3V0IE1paGFpIFBvcGVzY3UuIEkga25vdyBhYm91dCBoaXMgZXhwZXJpZW5jZSwgc2tpbGxzLCBwcm9qZWN0cywgYW5kIGNhbiBldmVuIGZldGNoIGhpcyBsYXRlc3QgR2l0SHViIHN0YXRzLiBXaGF0IHdvdWxkIHlvdSBsaWtlIHRvIGtub3c/XCI7XG5cbiAgICAvLyBHbG9iYWwgc3RhdGUgKGxpa2UgaGFtYnVyZ2VyLmpzIHNpbXBsZSBzdGF0ZSlcbiAgICBsZXQgaXNPcGVuID0gZmFsc2U7XG5cbiAgICAvLyBIZWxwZXIgZnVuY3Rpb25zIChsaWtlIGhhbWJ1cmdlci5qcyBoZWxwZXIgZnVuY3Rpb25zKVxuICAgIGZ1bmN0aW9uIGZvcm1hdE1lc3NhZ2UodGV4dCkge1xuICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcKlxcKiguKj8pXFwqXFwqL2csICc8c3Ryb25nPiQxPC9zdHJvbmc+JylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXCooLio/KVxcKi9nLCAnPGVtPiQxPC9lbT4nKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnPGJyPicpXG4gICAgICAgICAgICAucmVwbGFjZSgvKGNvbnRlbnRcXC9bXlxcc10rXFwuaHRtbCkvZywgJzxhIGhyZWY9XCIkMVwiIHRhcmdldD1cIl9ibGFua1wiIGNsYXNzPVwiY2hhdGJvdC1saW5rXCI+JDE8L2E+JylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9e4oCiIC9nbSwgJzxzcGFuIGNsYXNzPVwiYnVsbGV0XCI+4oCiPC9zcGFuPiAnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY3JvbGxUb0JvdHRvbSgpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZXNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC1tZXNzYWdlcycpO1xuICAgICAgICBpZiAobWVzc2FnZXNDb250YWluZXIpIHtcbiAgICAgICAgICAgIG1lc3NhZ2VzQ29udGFpbmVyLnNjcm9sbFRvKHtcbiAgICAgICAgICAgICAgICB0b3A6IG1lc3NhZ2VzQ29udGFpbmVyLnNjcm9sbEhlaWdodCxcbiAgICAgICAgICAgICAgICBiZWhhdmlvcjogJ3Ntb290aCcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZE1lc3NhZ2UoY29udGVudCwgc2VuZGVyLCBpc0Vycm9yID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZXNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC1tZXNzYWdlcycpO1xuICAgICAgICBpZiAoIW1lc3NhZ2VzQ29udGFpbmVyKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgbWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbWVzc2FnZUVsZW1lbnQuY2xhc3NOYW1lID0gYG1lc3NhZ2UgJHtzZW5kZXJ9YDtcbiAgICAgICAgaWYgKGlzRXJyb3IpIG1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG5cbiAgICAgICAgY29uc3QgZm9ybWF0dGVkQ29udGVudCA9IGZvcm1hdE1lc3NhZ2UoY29udGVudCk7XG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKFtdLCB7IGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcgfSk7XG5cbiAgICAgICAgbWVzc2FnZUVsZW1lbnQuaW5uZXJIVE1MID0gYFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlLWNvbnRlbnRcIj4ke2Zvcm1hdHRlZENvbnRlbnR9PC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtdGltZVwiPiR7dGltZXN0YW1wfTwvZGl2PlxuICAgICAgICBgO1xuXG4gICAgICAgIG1lc3NhZ2VzQ29udGFpbmVyLmFwcGVuZENoaWxkKG1lc3NhZ2VFbGVtZW50KTtcbiAgICAgICAgc2Nyb2xsVG9Cb3R0b20oKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaG93VHlwaW5nSW5kaWNhdG9yKCkge1xuICAgICAgICBjb25zdCBtZXNzYWdlc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LW1lc3NhZ2VzJyk7XG4gICAgICAgIGlmICghbWVzc2FnZXNDb250YWluZXIpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IHR5cGluZ0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdHlwaW5nRWxlbWVudC5jbGFzc05hbWUgPSAnbWVzc2FnZSBib3QgdHlwaW5nJztcbiAgICAgICAgdHlwaW5nRWxlbWVudC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtY29udGVudFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInR5cGluZy1pbmRpY2F0b3JcIj5cbiAgICAgICAgICAgICAgPHNwYW4+PC9zcGFuPlxuICAgICAgICAgICAgICA8c3Bhbj48L3NwYW4+XG4gICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuXG4gICAgICAgIG1lc3NhZ2VzQ29udGFpbmVyLmFwcGVuZENoaWxkKHR5cGluZ0VsZW1lbnQpO1xuICAgICAgICBzY3JvbGxUb0JvdHRvbSgpO1xuICAgICAgICByZXR1cm4gdHlwaW5nRWxlbWVudDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVUeXBpbmdJbmRpY2F0b3IodHlwaW5nRWxlbWVudCkge1xuICAgICAgICBpZiAodHlwaW5nRWxlbWVudCAmJiB0eXBpbmdFbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIHR5cGluZ0VsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0eXBpbmdFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvZ2dsZUNoYXRib3QoKSB7XG4gICAgICAgIGNvbnN0IGNoYXRib3RXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC13aW5kb3cnKTtcblxuICAgICAgICBpZiAoIWNoYXRib3RXaW5kb3cpIHJldHVybjtcblxuICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICBjbG9zZUNoYXRib3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYXRib3RXaW5kb3cuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgICAgIGlzT3BlbiA9IHRydWU7XG5cbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3QtaW5wdXQnKTtcbiAgICAgICAgICAgIGlmIChpbnB1dCkge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gaW5wdXQuZm9jdXMoKSwgQ0hBVEJPVF9VSV9DT05GSUcuZm9jdXNEZWxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbG9zZUNoYXRib3QoKSB7XG4gICAgICAgIGNvbnN0IGNoYXRib3RXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC13aW5kb3cnKTtcbiAgICAgICAgaWYgKGNoYXRib3RXaW5kb3cpIHtcbiAgICAgICAgICAgIGNoYXRib3RXaW5kb3cuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGlzT3BlbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZnVuY3Rpb24gc2VuZE1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBpZiAoIW1lc3NhZ2UudHJpbSgpKSByZXR1cm47XG5cbiAgICAgICAgYWRkTWVzc2FnZShtZXNzYWdlLCAndXNlcicpO1xuICAgICAgICBjb25zdCB0eXBpbmdJbmRpY2F0b3IgPSBzaG93VHlwaW5nSW5kaWNhdG9yKCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEFjY2VzcyBwcm9jZXNzTWVzc2FnZSBmcm9tIGdsb2JhbCBzY29wZSBvciBtb2R1bGVcbiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NNZXNzYWdlRm4gPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucHJvY2Vzc01lc3NhZ2VcbiAgICAgICAgICAgICAgICA/IHdpbmRvdy5wcm9jZXNzTWVzc2FnZVxuICAgICAgICAgICAgICAgIDogKHR5cGVvZiBwcm9jZXNzTWVzc2FnZSAhPT0gJ3VuZGVmaW5lZCcgPyBwcm9jZXNzTWVzc2FnZSA6IG51bGwpO1xuXG4gICAgICAgICAgICBpZiAoIXByb2Nlc3NNZXNzYWdlRm4pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3NNZXNzYWdlIGZ1bmN0aW9uIG5vdCBhdmFpbGFibGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwcm9jZXNzTWVzc2FnZUZuKG1lc3NhZ2UpO1xuICAgICAgICAgICAgcmVtb3ZlVHlwaW5nSW5kaWNhdG9yKHR5cGluZ0luZGljYXRvcik7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKHJlc3BvbnNlLCAnYm90Jyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZW1vdmVUeXBpbmdJbmRpY2F0b3IodHlwaW5nSW5kaWNhdG9yKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgbWVzc2FnZTonLCBlcnJvcik7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKCdTb3JyeSwgSSBlbmNvdW50ZXJlZCBhbiBlcnJvci4gUGxlYXNlIHRyeSBhZ2Fpbi4nLCAnYm90JywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGF0Ym90Q29udGFpbmVyKCkge1xuICAgICAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoQ0hBVEJPVF9VSV9DT05GSUcuY29udGFpbmVySWQpO1xuICAgICAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb250YWluZXIuaWQgPSBDSEFUQk9UX1VJX0NPTkZJRy5jb250YWluZXJJZDtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF0dGFjaEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBjb25zdCB0b2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC10b2dnbGUnKTtcbiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC1jbG9zZScpO1xuICAgICAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3QtaW5wdXQtZm9ybScpO1xuICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LWlucHV0Jyk7XG5cbiAgICAgICAgaWYgKHRvZ2dsZSkge1xuICAgICAgICAgICAgdG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlQ2hhdGJvdCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2xvc2VCdG4pIHtcbiAgICAgICAgICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VDaGF0Ym90KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBpbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdWJtaXQnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNob3dXZWxjb21lTWVzc2FnZSgpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBhZGRNZXNzYWdlKFdFTENPTUVfTUVTU0FHRSwgJ2JvdCcpO1xuICAgICAgICB9LCBDSEFUQk9UX1VJX0NPTkZJRy53ZWxjb21lRGVsYXkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFyQ2hhdCgpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZXNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC1tZXNzYWdlcycpO1xuICAgICAgICBpZiAobWVzc2FnZXNDb250YWluZXIpIHtcbiAgICAgICAgICAgIG1lc3NhZ2VzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWNjZXNzIGNsZWFySGlzdG9yeSBmcm9tIGdsb2JhbCBzY29wZSBvciBtb2R1bGVcbiAgICAgICAgY29uc3QgY2xlYXJIaXN0b3J5Rm4gPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuY2xlYXJIaXN0b3J5XG4gICAgICAgICAgICA/IHdpbmRvdy5jbGVhckhpc3RvcnlcbiAgICAgICAgICAgIDogKHR5cGVvZiBjbGVhckhpc3RvcnkgIT09ICd1bmRlZmluZWQnID8gY2xlYXJIaXN0b3J5IDogbnVsbCk7XG5cbiAgICAgICAgaWYgKGNsZWFySGlzdG9yeUZuKSB7XG4gICAgICAgICAgICBjbGVhckhpc3RvcnlGbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2hvd1dlbGNvbWVNZXNzYWdlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXV0b0luaXRpYWxpemVDaGF0Ym90KCkge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBjcmVhdGVDaGF0Ym90Q29udGFpbmVyKCk7XG4gICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBDSEFUQk9UX0hUTUw7XG4gICAgICAgIGF0dGFjaEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHNob3dXZWxjb21lTWVzc2FnZSgpO1xuICAgIH1cblxuICAgIC8vIEV4cG9ydCBmb3IgdGVzdGluZyAobGlrZSBoYW1idXJnZXIuanMgZXhwb3J0cylcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgICAgICAgICB0b2dnbGVDaGF0Ym90LFxuICAgICAgICAgICAgc2VuZE1lc3NhZ2UsXG4gICAgICAgICAgICBjbGVhckNoYXQsXG4gICAgICAgICAgICBhZGRNZXNzYWdlLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIE1ha2UgYXZhaWxhYmxlIGdsb2JhbGx5IChsaWtlIGhhbWJ1cmdlci5qcylcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93LnRvZ2dsZUNoYXRib3QgPSB0b2dnbGVDaGF0Ym90O1xuICAgICAgICB3aW5kb3cuY2xlYXJDaGF0ID0gY2xlYXJDaGF0O1xuICAgICAgICB3aW5kb3cuc2VuZE1lc3NhZ2UgPSBzZW5kTWVzc2FnZTtcbiAgICAgICAgd2luZG93LmFkZE1lc3NhZ2UgPSBhZGRNZXNzYWdlO1xuICAgIH1cblxuICAgIC8vIEF1dG8taW5pdGlhbGl6ZSAobGlrZSBuYXZpZ2F0aW9uLmpzKVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBhdXRvSW5pdGlhbGl6ZUNoYXRib3QpO1xufSkoKTsgIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbl9fd2VicGFja19yZXF1aXJlX18oMjI3KTtcbl9fd2VicGFja19yZXF1aXJlX18oNjg4Mik7XG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNTY5NCk7XG4iXSwibmFtZXMiOlsiQ0hBVEJPVF9DT05GSUciLCJnaXRodWJVc2VybmFtZSIsIm9wZW5haU1vZGVsIiwibWF4VG9rZW5zIiwidGVtcGVyYXR1cmUiLCJnaXRodWJLZXl3b3JkcyIsImdpdGh1YiIsImJhc2VVcmwiLCJyZXBvTGltaXQiLCJldmVudExpbWl0IiwiZGlzcGxheVJlcG9MaW1pdCIsImRpc3BsYXlBY3Rpdml0eUxpbWl0IiwiZXhjbHVkZVBhdHRlcm5zIiwiQ2hhdGJvdCIsImNvbnN0cnVjdG9yIiwidGhpcyIsImh0bWxDb250ZW50Iiwic3lzdGVtUHJvbXB0IiwiY29udmVyc2F0aW9uSGlzdG9yeSIsImxvYWRDb250ZW50SW5kZXgiLCJpbmRleFJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIkVycm9yIiwic3RhdHVzIiwianNvbiIsImxvYWRTaW5nbGVDb250ZW50RmlsZSIsImZpbGVuYW1lIiwicmVzcG9uc2UiLCJjb250ZW50IiwidGV4dCIsImZpbGVUeXBlIiwiZW5kc1dpdGgiLCJsb2FkQWxsQ29udGVudEZpbGVzIiwiY29udGVudEZpbGVzIiwiY29tYmluZWRDb250ZW50IiwibG9hZENvbnRlbnRGaWxlcyIsImNyZWF0ZVN5c3RlbVByb21wdCIsImNvbnRlbnREYXRhIiwiZ2l0aHViQ29udGV4dCIsIm1lc3NhZ2VSZXF1aXJlc0dpdGh1YlN0YXRzIiwibWVzc2FnZSIsImxvd2VyTWVzc2FnZSIsInRvTG93ZXJDYXNlIiwic29tZSIsImtleXdvcmQiLCJpbmNsdWRlcyIsInNob3VsZEZpbHRlclJlcG8iLCJyZXBvIiwicmVwb1VybCIsImh0bWxfdXJsIiwidXJsIiwicmVwb05hbWUiLCJuYW1lIiwiZnVsbE5hbWUiLCJmdWxsX25hbWUiLCJwYXR0ZXJuIiwic2hvdWxkRmlsdGVyRXZlbnQiLCJldmVudCIsImJ1aWxkR2l0SHViVXJsIiwiZW5kcG9pbnQiLCJmZXRjaEdpdEh1YkRhdGEiLCJlcnJvck1lc3NhZ2UiLCJlcnJvciIsImNvbnNvbGUiLCJmZXRjaEdpdEh1YlN0YXRzIiwicHJvZmlsZSIsInJlcG9zRGF0YSIsImV2ZW50c0RhdGEiLCJQcm9taXNlIiwiYWxsU2V0dGxlZCIsImZldGNoR2l0SHViUmVwb3MiLCJmZXRjaEdpdEh1YkV2ZW50cyIsImV4dHJhY3RCYXNpY1Byb2ZpbGUiLCJyZXBvc2l0b3JpZXMiLCJ2YWx1ZSIsInJlY2VudF9hY3Rpdml0eSIsInB1YmxpY19yZXBvcyIsImZvbGxvd2VycyIsImZvbGxvd2luZyIsImNyZWF0ZWRfYXQiLCJiaW8iLCJsb2NhdGlvbiIsImNvbXBhbnkiLCJyZXBvcyIsImZpbHRlciIsIm1hcCIsInRyYW5zZm9ybVJlcG8iLCJldmVudHMiLCJ0cmFuc2Zvcm1FdmVudCIsImJpbmQiLCJkZXNjcmlwdGlvbiIsImxhbmd1YWdlIiwic3RhcnMiLCJzdGFyZ2F6ZXJzX2NvdW50IiwidXBkYXRlZF9hdCIsInR5cGUiLCJhY3Rpb24iLCJmb3JtYXRFdmVudEFjdGlvbiIsImNvbW1pdENvdW50IiwicGF5bG9hZCIsImNvbW1pdHMiLCJsZW5ndGgiLCJyZWZfdHlwZSIsInJlZiIsInJlcGxhY2UiLCJmb3JtYXRHaXRodWJTdGF0c0ZvckNvbnRleHQiLCJzdGF0cyIsImZvcm1hdEJhc2ljR2l0SHViU3RhdHMiLCJmb3JtYXRSZXBvc2l0b3JpZXNTZWN0aW9uIiwiZm9ybWF0QWN0aXZpdHlTZWN0aW9uIiwiQm9vbGVhbiIsImpvaW4iLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJzbGljZSIsImZvcm1hdFJlcG9zaXRvcnkiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJhY3Rpdml0aWVzIiwiY29tbWl0U3RhdHMiLCJjYWxjdWxhdGVDb21taXRTdGF0cyIsImZvcm1hdEFjdGl2aXR5U3VtbWFyeSIsInRvdGFsQ29tbWl0cyIsImFjdGl2ZVJlcG9zIiwibW9zdFJlY2VudERhdGUiLCJTZXQiLCJmb3JFYWNoIiwiYWN0aXZpdHkiLCJwcm9jZXNzQWN0aXZpdHlGb3JTdGF0cyIsInNpemUiLCJleHRyYWN0Q29tbWl0Q291bnQiLCJleHRyYWN0UmVwb05hbWUiLCJhZGQiLCJ1cGRhdGVNb3N0UmVjZW50RGF0ZSIsImFjdGlvblRleHQiLCJjb21taXRNYXRjaCIsIm1hdGNoIiwicGFyc2VJbnQiLCJyZXBvRnVsbE5hbWUiLCJkYXRlU3RyaW5nIiwiYWN0aXZpdHlEYXRlIiwiZm9ybWF0QWN0aXZpdHkiLCJkYXRlIiwiaW5pdGlhbGl6ZSIsImFkZE1lc3NhZ2VUb0hpc3RvcnkiLCJyb2xlIiwidGltZXN0YW1wIiwicHVzaCIsImdldEdpdGh1YkNvbnRleHRJZk5lZWRlZCIsImNyZWF0ZUVycm9yUmVzcG9uc2UiLCJwcm9jZXNzTWVzc2FnZSIsImdlbmVyYXRlQUlSZXNwb25zZSIsImVycm9yUmVzcG9uc2UiLCJidWlsZE1lc3NhZ2VzRm9yQUkiLCJjYWxsT3BlbkFJQVBJIiwibWVzc2FnZXMiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtb2RlbCIsIm1heF90b2tlbnMiLCJlcnJvckRhdGEiLCJjYXRjaCIsImNob2ljZXMiLCJjbGVhckhpc3RvcnkiLCJnZXRIaXN0b3J5IiwiY2hhdGJvdEluc3RhbmNlIiwiZ2V0Q2hhdGJvdEluc3RhbmNlIiwiYXN5bmMiLCJpbml0aWFsaXplQ2hhdGJvdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJ3aW5kb3ciLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb250YWluZXIiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsImFwcGVuZENoaWxkIiwibG9nIiwiQ0hBVEJPVF9VSV9DT05GSUciLCJpc09wZW4iLCJzY3JvbGxUb0JvdHRvbSIsIm1lc3NhZ2VzQ29udGFpbmVyIiwicXVlcnlTZWxlY3RvciIsInNjcm9sbFRvIiwidG9wIiwic2Nyb2xsSGVpZ2h0IiwiYmVoYXZpb3IiLCJhZGRNZXNzYWdlIiwic2VuZGVyIiwiaXNFcnJvciIsIm1lc3NhZ2VFbGVtZW50IiwiY2xhc3NOYW1lIiwiY2xhc3NMaXN0IiwiZm9ybWF0dGVkQ29udGVudCIsInRvTG9jYWxlVGltZVN0cmluZyIsImhvdXIiLCJtaW51dGUiLCJpbm5lckhUTUwiLCJyZW1vdmVUeXBpbmdJbmRpY2F0b3IiLCJ0eXBpbmdFbGVtZW50IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwidG9nZ2xlQ2hhdGJvdCIsImNoYXRib3RXaW5kb3ciLCJjbG9zZUNoYXRib3QiLCJzdHlsZSIsImRpc3BsYXkiLCJpbnB1dCIsInNldFRpbWVvdXQiLCJmb2N1cyIsInNlbmRNZXNzYWdlIiwidHJpbSIsInR5cGluZ0luZGljYXRvciIsInNob3dUeXBpbmdJbmRpY2F0b3IiLCJwcm9jZXNzTWVzc2FnZUZuIiwic2hvd1dlbGNvbWVNZXNzYWdlIiwiY2xlYXJDaGF0IiwiY2xlYXJIaXN0b3J5Rm4iLCJjcmVhdGVDaGF0Ym90Q29udGFpbmVyIiwidG9nZ2xlIiwiY2xvc2VCdG4iLCJmb3JtIiwiZSIsInByZXZlbnREZWZhdWx0Iiwia2V5Iiwic2hpZnRLZXkiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJhdHRhY2hFdmVudExpc3RlbmVycyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIl0sInNvdXJjZVJvb3QiOiIifQ==