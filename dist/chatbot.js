(()=>{var t={227:t=>{!function(){"use strict";const e={githubUsername:"MihaiOnSoftware",openaiModel:"gpt-3.5-turbo",maxTokens:150,temperature:.7,githubKeywords:["github","repository","repo","repositories","code","commits","contributions","followers","following","projects"],github:{baseUrl:"https://api.github.com",repoLimit:10,eventLimit:5,displayRepoLimit:5,displayActivityLimit:3,excludePatterns:["nulogy/"]}};class n{constructor(){this.htmlContent=null,this.systemPrompt=null,this.conversationHistory=[]}async loadContentIndex(){const t=await fetch("html-files-index.json");if(!t.ok)throw new Error(`Failed to load content files index: ${t.status}`);return t.json()}async loadSingleContentFile(t){const e=await fetch(t),n=await e.text(),s=t.endsWith(".md")?"Markdown":"HTML";return`\n\n=== Content from ${t} (${s}) ===\n${n}`}async loadAllContentFiles(t){let e="";for(const n of t)e+=await this.loadSingleContentFile(n);return e}async loadContentFiles(){const t=await this.loadContentIndex();return this.loadAllContentFiles(t)}createSystemPrompt(t,e=""){return`\n            You are Mihai Popescu, a software developer, chatting casually about yourself. Keep responses short and conversational.\n\n            Here is your complete website content and professional information:\n            ${t}\n\n            ${e}\n\n            TONE & STYLE:\n            - Talk like you're having a casual conversation with a friend\n            - Keep answers brief (1-2 sentences max unless asked for details)\n            - Use "I" naturally - you ARE Mihai\n            - Be enthusiastic but not over-the-top\n            - Skip formal language - be relaxed and approachable\n\n            GUIDELINES:\n            - Answer from the info above, but keep it concise\n            - If someone asks about tech stuff, mention it briefly then ask if they want more details\n            - For GitHub questions, I can pull live stats\n            - If you don't know something, just say so casually\n            - Use emojis sparingly (maybe 1 per response max)\n            `}messageRequiresGithubStats(t){const n=t.toLowerCase();return e.githubKeywords.some(t=>n.includes(t))}shouldFilterRepo(t){const n=t.html_url||t.url||"",s=t.name||"",o=t.full_name||"";return e.github.excludePatterns.some(t=>n.includes(t)||s.includes(t)||o.includes(t))}shouldFilterEvent(t){const n=t.repo?.name||"";return e.github.excludePatterns.some(t=>n.includes(t))}buildGitHubUrl(t){return`${e.github.baseUrl}/users/${e.githubUsername}${t}`}async fetchGitHubData(t,e){try{const e=await fetch(t);return e.ok?await e.json():null}catch(t){return console.error(e,t),null}}async fetchGitHubStats(){try{const t=await this.fetchGitHubData(this.buildGitHubUrl(""),"Error fetching GitHub profile:");if(!t)return null;const[e,n]=await Promise.allSettled([this.fetchGitHubRepos(),this.fetchGitHubEvents()]);return{...this.extractBasicProfile(t),repositories:"fulfilled"===e.status?e.value:null,recent_activity:"fulfilled"===n.status?n.value:null}}catch(t){return console.error("Error fetching GitHub stats:",t),null}}extractBasicProfile(t){return{public_repos:t.public_repos,followers:t.followers,following:t.following,created_at:t.created_at,bio:t.bio,location:t.location,company:t.company}}async fetchGitHubRepos(){const t=this.buildGitHubUrl(`/repos?sort=updated&per_page=${e.github.repoLimit}`),n=await this.fetchGitHubData(t,"Error fetching GitHub repositories:");return n?n.filter(t=>!this.shouldFilterRepo(t)).map(this.transformRepo):null}async fetchGitHubEvents(){const t=this.buildGitHubUrl(`/events?per_page=${e.github.eventLimit}`),n=await this.fetchGitHubData(t,"Error fetching GitHub events:");return n?n.filter(t=>!this.shouldFilterEvent(t)).map(this.transformEvent.bind(this)).filter(t=>t.repo):null}transformRepo(t){return{name:t.name,description:t.description,language:t.language,stars:t.stargazers_count,updated_at:t.updated_at,url:t.html_url}}transformEvent(t){return{type:t.type,repo:t.repo?.name,created_at:t.created_at,action:this.formatEventAction(t)}}formatEventAction(t){switch(t.type){case"PushEvent":const e=t.payload?.commits?.length||0;return`Pushed ${e} commit${1!==e?"s":""}`;case"CreateEvent":return`Created ${t.payload?.ref_type} ${t.payload?.ref}`;case"PullRequestEvent":return`${t.payload?.action} pull request`;case"IssuesEvent":return`${t.payload?.action} issue`;case"ForkEvent":return"Forked repository";case"WatchEvent":return"Starred repository";default:return t.type.replace("Event","")}}formatGithubStatsForContext(t){return[this.formatBasicGitHubStats(t),this.formatRepositoriesSection(t.repositories),this.formatActivitySection(t.recent_activity)].filter(Boolean).join("\n")}formatBasicGitHubStats(t){return`\n            CURRENT GITHUB STATISTICS:\n            - Public repositories: ${t.public_repos}\n            - Followers: ${t.followers}\n            - Following: ${t.following}\n            - Member since: ${new Date(t.created_at).getFullYear()}\n            - Bio: ${t.bio}\n            - Location: ${t.location}\n            - Company: ${t.company}\n            `}formatRepositoriesSection(t){return t?.length?`\n            RECENT REPOSITORIES:\n            ${t.slice(0,e.github.displayRepoLimit).map(this.formatRepository).join("\n            ")}`:null}formatRepository(t){return[`- ${t.name}`,t.language?`(${t.language})`:"",t.description?`- ${t.description}`:"",t.stars>0?`â­${t.stars}`:"",`(Updated: ${new Date(t.updated_at).toLocaleDateString()})`].filter(Boolean).join(" ")}formatActivitySection(t){return t?.length?`\n            RECENT ACTIVITY:\n            ${t.slice(0,e.github.displayActivityLimit).map(this.formatActivity).join("\n            ")}`:null}formatActivity(t){const e=new Date(t.created_at).toLocaleDateString(),n=t.repo.replace("MihaiOnSoftware/","");return`- ${t.action} in ${n} (${e})`}async initialize(){this.htmlContent||(this.htmlContent=await this.loadContentFiles(),this.systemPrompt=this.createSystemPrompt(this.htmlContent))}addMessageToHistory(t,e){const n={role:t,content:e,timestamp:new Date};return this.conversationHistory.push(n),n}async getGithubContextIfNeeded(t){if(!this.messageRequiresGithubStats(t))return"";const e=await this.fetchGitHubStats();return e?this.formatGithubStatsForContext(e):""}createErrorResponse(t){return t.message.includes("429")||t.message.includes("high demand")?"I'm currently experiencing high demand. Please wait a moment and try again. ðŸ•":"I'm sorry, I encountered an error processing your message. Please try again."}async processMessage(t){await this.initialize(),this.addMessageToHistory("user",t);try{const e=await this.getGithubContextIfNeeded(t),n=await this.generateAIResponse(t,e);return this.addMessageToHistory("assistant",n),n}catch(t){console.error("Error processing message:",t);const e=this.createErrorResponse(t);return this.addMessageToHistory("assistant",e),e}}buildMessagesForAI(t,e){return[{role:"system",content:this.createSystemPrompt(this.htmlContent,e)},...this.conversationHistory.slice(-10),{role:"user",content:t}]}async callOpenAIAPI(t){const n=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e.openaiModel,messages:t,max_tokens:e.maxTokens,temperature:e.temperature})});if(!n.ok){const t=await n.json().catch(()=>({}));throw new Error(t.error||`Server error: ${n.status}`)}return(await n.json()).choices[0].message.content}async generateAIResponse(t,e){const n=this.buildMessagesForAI(t,e);return this.callOpenAIAPI(n)}clearHistory(){this.conversationHistory=[]}getHistory(){return[...this.conversationHistory]}}let s=null;function o(){return s||(s=new n),s}async function i(t){return o().processMessage(t)}function a(){o().clearHistory()}function r(){return o().getHistory()}async function c(){return o().initialize()}t.exports&&(t.exports={Chatbot:n,processMessage:i,clearHistory:a,getHistory:r,initializeChatbot:c}),"undefined"!=typeof window&&(window.processMessage=i,window.clearHistory=a,window.getHistory=r,window.initializeChatbot=c)}()},5694:(t,e,n)=>{"use strict";n(227),n(6882),document.addEventListener("DOMContentLoaded",function(){let t=document.getElementById("chatbot-container");t||(t=document.createElement("div"),t.id="chatbot-container",document.body.appendChild(t)),console.log("Chatbot initialized successfully")})},6882:t=>{!function(){"use strict";const e="chatbot-container";let n=!1;function s(){const t=document.querySelector(".chatbot-messages");t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}function o(t,e,n=!1){const o=document.querySelector(".chatbot-messages");if(!o)return;const i=document.createElement("div");i.className=`message ${e}`,n&&i.classList.add("error");const a=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>").replace(/(content\/[^\s]+\.html)/g,'<a href="$1" target="_blank" class="chatbot-link">$1</a>').replace(/^â€¢ /gm,'<span class="bullet">â€¢</span> '),r=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});i.innerHTML=`\n          <div class="message-content">${a}</div>\n          <div class="message-time">${r}</div>\n        `,o.appendChild(i),s()}function i(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function a(){const t=document.querySelector(".chatbot-window");if(t)if(n)r();else{t.style.display="flex",n=!0;const e=document.querySelector(".chatbot-input");e&&setTimeout(()=>e.focus(),100)}}function r(){const t=document.querySelector(".chatbot-window");t&&(t.style.display="none",n=!1)}async function c(t){if(!t.trim())return;o(t,"user");const e=function(){const t=document.querySelector(".chatbot-messages");if(!t)return null;const e=document.createElement("div");return e.className="message bot typing",e.innerHTML='\n          <div class="message-content">\n            <div class="typing-indicator">\n              <span></span>\n              <span></span>\n              <span></span>\n            </div>\n          </div>\n        ',t.appendChild(e),s(),e}();try{const n="undefined"!=typeof window&&window.processMessage?window.processMessage:"undefined"!=typeof processMessage?processMessage:null;if(!n)throw new Error("processMessage function not available");const s=await n(t);i(e),o(s,"bot")}catch(t){i(e),console.error("Error sending message:",t),o("Sorry, I encountered an error. Please try again.","bot",!0)}}function l(){setTimeout(()=>{o("ðŸ‘‹ Hi there! I'm an AI assistant that can answer questions about Mihai Popescu. I know about his experience, skills, projects, and can even fetch his latest GitHub stats. What would you like to know?","bot")},500)}function u(){const t=document.querySelector(".chatbot-messages");t&&(t.innerHTML="");const e="undefined"!=typeof window&&window.clearHistory?window.clearHistory:"undefined"!=typeof clearHistory?clearHistory:null;e&&e(),l()}t.exports&&(t.exports={toggleChatbot:a,sendMessage:c,clearChat:u,addMessage:o}),"undefined"!=typeof window&&(window.toggleChatbot=a,window.clearChat=u,window.sendMessage=c,window.addMessage=o),document.addEventListener("DOMContentLoaded",function(){(function(){let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,document.body.appendChild(t)),t}()).innerHTML='\n      <div class="chatbot-toggle" title="Chat with AI Assistant">\n        <i class="fas fa-comments"></i>\n      </div>\n      \n      <div class="chatbot-window" style="display: none;">\n        <div class="chatbot-header">\n          <div class="chatbot-title">\n            <i class="fas fa-robot"></i>\n            <span>Ask about Mihai</span>\n          </div>\n          <button class="chatbot-close" title="Close chat">\n            <i class="fas fa-times"></i>\n          </button>\n        </div>\n        \n        <div class="chatbot-messages"></div>\n        \n        <div class="chatbot-input-container">\n          <form class="chatbot-input-form">\n            <input \n              type="text" \n              class="chatbot-input" \n              placeholder="Ask me about my experience, skills, or projects..."\n              autocomplete="off"\n            />\n            <button type="submit" class="chatbot-send" title="Send message">\n              <i class="fas fa-paper-plane"></i>\n            </button>\n          </form>\n        </div>\n      </div>\n    ',function(){const t=document.querySelector(".chatbot-toggle"),e=document.querySelector(".chatbot-close"),n=document.querySelector(".chatbot-input-form"),s=document.querySelector(".chatbot-input");t&&t.addEventListener("click",a),e&&e.addEventListener("click",r),n&&n.addEventListener("submit",t=>{t.preventDefault();const e=s.value.trim();e&&(c(e),s.value="")}),s&&s.addEventListener("keypress",t=>{"Enter"!==t.key||t.shiftKey||(t.preventDefault(),n&&n.dispatchEvent(new Event("submit")))})}(),l()})}()}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var i=e[s]={exports:{}};return t[s](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n(227),n(6882),n(5694)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixLQUFTTSxFQUFvQlcsRUFBRTFFLEVBQVN5RCxJQUM1RWtCLE9BQU9DLGVBQWU1RSxFQUFTeUQsRUFBSyxDQUFFb0IsWUFBWSxFQUFNQyxJQUFLTCxFQUFXaEIsTUNKM0VNLEVBQW9CVyxFQUFJLENBQUNLLEVBQUtDLElBQVVMLE9BQU9NLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDR2xGakIsRUFBb0IsS0FDcEJBLEVBQW9CLE1BQ01BLEVBQW9CLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvLi9zcmMvY2hhdGJvdC5qcyIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvLi9zcmMvY2hhdGJvdC1pbml0LmpzIiwid2VicGFjazovL21paGFpLXJlc3VtZS8uL3NyYy9jaGF0Ym90LXVpLmpzIiwid2VicGFjazovL21paGFpLXJlc3VtZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vbWloYWktcmVzdW1lL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9taWhhaS1yZXN1bWUvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gQ29uZmlndXJhdGlvbiBjb25zdGFudHNcbiAgICBjb25zdCBDSEFUQk9UX0NPTkZJRyA9IHtcbiAgICAgICAgZ2l0aHViVXNlcm5hbWU6ICdNaWhhaU9uU29mdHdhcmUnLFxuICAgICAgICBvcGVuYWlNb2RlbDogJ2dwdC0zLjUtdHVyYm8nLFxuICAgICAgICBtYXhUb2tlbnM6IDE1MCxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgZ2l0aHViS2V5d29yZHM6IFsnZ2l0aHViJywgJ3JlcG9zaXRvcnknLCAncmVwbycsICdyZXBvc2l0b3JpZXMnLCAnY29kZScsICdjb21taXRzJywgJ2NvbnRyaWJ1dGlvbnMnLCAnZm9sbG93ZXJzJywgJ2ZvbGxvd2luZycsICdwcm9qZWN0cyddLFxuXG4gICAgICAgIC8vIEdpdEh1YiBBUEkgY29uZmlndXJhdGlvblxuICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICAgIGJhc2VVcmw6ICdodHRwczovL2FwaS5naXRodWIuY29tJyxcbiAgICAgICAgICAgIHJlcG9MaW1pdDogMTAsXG4gICAgICAgICAgICBldmVudExpbWl0OiA1LFxuICAgICAgICAgICAgZGlzcGxheVJlcG9MaW1pdDogNSxcbiAgICAgICAgICAgIGRpc3BsYXlBY3Rpdml0eUxpbWl0OiAzLFxuICAgICAgICAgICAgLy8gRmlsdGVyaW5nIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgIGV4Y2x1ZGVQYXR0ZXJuczogWydudWxvZ3kvJ10sXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGNsYXNzIENoYXRib3Qge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHRoaXMuaHRtbENvbnRlbnQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5zeXN0ZW1Qcm9tcHQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25IaXN0b3J5ID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBsb2FkQ29udGVudEluZGV4KCkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXhSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodG1sLWZpbGVzLWluZGV4Lmpzb24nKTtcbiAgICAgICAgICAgIGlmICghaW5kZXhSZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGxvYWQgY29udGVudCBmaWxlcyBpbmRleDogJHtpbmRleFJlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbmRleFJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIGxvYWRTaW5nbGVDb250ZW50RmlsZShmaWxlbmFtZSkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChmaWxlbmFtZSk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgY29uc3QgZmlsZVR5cGUgPSBmaWxlbmFtZS5lbmRzV2l0aCgnLm1kJykgPyAnTWFya2Rvd24nIDogJ0hUTUwnO1xuICAgICAgICAgICAgcmV0dXJuIGBcXG5cXG49PT0gQ29udGVudCBmcm9tICR7ZmlsZW5hbWV9ICgke2ZpbGVUeXBlfSkgPT09XFxuJHtjb250ZW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBsb2FkQWxsQ29udGVudEZpbGVzKGNvbnRlbnRGaWxlcykge1xuICAgICAgICAgICAgbGV0IGNvbWJpbmVkQ29udGVudCA9ICcnO1xuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlbmFtZSBvZiBjb250ZW50RmlsZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMubG9hZFNpbmdsZUNvbnRlbnRGaWxlKGZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICBjb21iaW5lZENvbnRlbnQgKz0gZmlsZUNvbnRlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29tYmluZWRDb250ZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgbG9hZENvbnRlbnRGaWxlcygpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRGaWxlcyA9IGF3YWl0IHRoaXMubG9hZENvbnRlbnRJbmRleCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZEFsbENvbnRlbnRGaWxlcyhjb250ZW50RmlsZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3JlYXRlU3lzdGVtUHJvbXB0KGNvbnRlbnREYXRhLCBnaXRodWJDb250ZXh0ID0gJycpIHtcbiAgICAgICAgICAgIHJldHVybiBgXG4gICAgICAgICAgICBZb3UgYXJlIE1paGFpIFBvcGVzY3UsIGEgc29mdHdhcmUgZGV2ZWxvcGVyLCBjaGF0dGluZyBjYXN1YWxseSBhYm91dCB5b3Vyc2VsZi4gS2VlcCByZXNwb25zZXMgc2hvcnQgYW5kIGNvbnZlcnNhdGlvbmFsLlxuXG4gICAgICAgICAgICBIZXJlIGlzIHlvdXIgY29tcGxldGUgd2Vic2l0ZSBjb250ZW50IGFuZCBwcm9mZXNzaW9uYWwgaW5mb3JtYXRpb246XG4gICAgICAgICAgICAke2NvbnRlbnREYXRhfVxuXG4gICAgICAgICAgICAke2dpdGh1YkNvbnRleHR9XG5cbiAgICAgICAgICAgIFRPTkUgJiBTVFlMRTpcbiAgICAgICAgICAgIC0gVGFsayBsaWtlIHlvdSdyZSBoYXZpbmcgYSBjYXN1YWwgY29udmVyc2F0aW9uIHdpdGggYSBmcmllbmRcbiAgICAgICAgICAgIC0gS2VlcCBhbnN3ZXJzIGJyaWVmICgxLTIgc2VudGVuY2VzIG1heCB1bmxlc3MgYXNrZWQgZm9yIGRldGFpbHMpXG4gICAgICAgICAgICAtIFVzZSBcIklcIiBuYXR1cmFsbHkgLSB5b3UgQVJFIE1paGFpXG4gICAgICAgICAgICAtIEJlIGVudGh1c2lhc3RpYyBidXQgbm90IG92ZXItdGhlLXRvcFxuICAgICAgICAgICAgLSBTa2lwIGZvcm1hbCBsYW5ndWFnZSAtIGJlIHJlbGF4ZWQgYW5kIGFwcHJvYWNoYWJsZVxuXG4gICAgICAgICAgICBHVUlERUxJTkVTOlxuICAgICAgICAgICAgLSBBbnN3ZXIgZnJvbSB0aGUgaW5mbyBhYm92ZSwgYnV0IGtlZXAgaXQgY29uY2lzZVxuICAgICAgICAgICAgLSBJZiBzb21lb25lIGFza3MgYWJvdXQgdGVjaCBzdHVmZiwgbWVudGlvbiBpdCBicmllZmx5IHRoZW4gYXNrIGlmIHRoZXkgd2FudCBtb3JlIGRldGFpbHNcbiAgICAgICAgICAgIC0gRm9yIEdpdEh1YiBxdWVzdGlvbnMsIEkgY2FuIHB1bGwgbGl2ZSBzdGF0c1xuICAgICAgICAgICAgLSBJZiB5b3UgZG9uJ3Qga25vdyBzb21ldGhpbmcsIGp1c3Qgc2F5IHNvIGNhc3VhbGx5XG4gICAgICAgICAgICAtIFVzZSBlbW9qaXMgc3BhcmluZ2x5IChtYXliZSAxIHBlciByZXNwb25zZSBtYXgpXG4gICAgICAgICAgICBgO1xuICAgICAgICB9XG5cbiAgICAgICAgbWVzc2FnZVJlcXVpcmVzR2l0aHViU3RhdHMobWVzc2FnZSkge1xuICAgICAgICAgICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgcmV0dXJuIENIQVRCT1RfQ09ORklHLmdpdGh1YktleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoa2V5d29yZCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgYSByZXBvc2l0b3J5IHNob3VsZCBiZSBmaWx0ZXJlZCBvdXRcbiAgICAgICAgc2hvdWxkRmlsdGVyUmVwbyhyZXBvKSB7XG4gICAgICAgICAgICBjb25zdCByZXBvVXJsID0gcmVwby5odG1sX3VybCB8fCByZXBvLnVybCB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IHJlcG9OYW1lID0gcmVwby5uYW1lIHx8ICcnO1xuICAgICAgICAgICAgY29uc3QgZnVsbE5hbWUgPSByZXBvLmZ1bGxfbmFtZSB8fCAnJztcblxuICAgICAgICAgICAgcmV0dXJuIENIQVRCT1RfQ09ORklHLmdpdGh1Yi5leGNsdWRlUGF0dGVybnMuc29tZShwYXR0ZXJuID0+XG4gICAgICAgICAgICAgICAgcmVwb1VybC5pbmNsdWRlcyhwYXR0ZXJuKSB8fFxuICAgICAgICAgICAgICAgIHJlcG9OYW1lLmluY2x1ZGVzKHBhdHRlcm4pIHx8XG4gICAgICAgICAgICAgICAgZnVsbE5hbWUuaW5jbHVkZXMocGF0dGVybilcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBhbiBldmVudCBzaG91bGQgYmUgZmlsdGVyZWQgb3V0XG4gICAgICAgIHNob3VsZEZpbHRlckV2ZW50KGV2ZW50KSB7XG4gICAgICAgICAgICBjb25zdCByZXBvTmFtZSA9IGV2ZW50LnJlcG8/Lm5hbWUgfHwgJyc7XG5cbiAgICAgICAgICAgIHJldHVybiBDSEFUQk9UX0NPTkZJRy5naXRodWIuZXhjbHVkZVBhdHRlcm5zLnNvbWUocGF0dGVybiA9PlxuICAgICAgICAgICAgICAgIHJlcG9OYW1lLmluY2x1ZGVzKHBhdHRlcm4pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGVscGVyIG1ldGhvZCB0byBidWlsZCBHaXRIdWIgQVBJIFVSTHNcbiAgICAgICAgYnVpbGRHaXRIdWJVcmwoZW5kcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtDSEFUQk9UX0NPTkZJRy5naXRodWIuYmFzZVVybH0vdXNlcnMvJHtDSEFUQk9UX0NPTkZJRy5naXRodWJVc2VybmFtZX0ke2VuZHBvaW50fWA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZW5lcmljIEdpdEh1YiBBUEkgZmV0Y2ggd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgICAgICBhc3luYyBmZXRjaEdpdEh1YkRhdGEodXJsLCBlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBmZXRjaEdpdEh1YlN0YXRzKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBGZXRjaCBiYXNpYyBwcm9maWxlIHN0YXRzXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZSA9IGF3YWl0IHRoaXMuZmV0Y2hHaXRIdWJEYXRhKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkR2l0SHViVXJsKCcnKSxcbiAgICAgICAgICAgICAgICAgICAgJ0Vycm9yIGZldGNoaW5nIEdpdEh1YiBwcm9maWxlOicsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAoIXByb2ZpbGUpIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgICAgICAgLy8gRmV0Y2ggYWRkaXRpb25hbCBkYXRhIGluIHBhcmFsbGVsXG4gICAgICAgICAgICAgICAgY29uc3QgW3JlcG9zRGF0YSwgZXZlbnRzRGF0YV0gPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZldGNoR2l0SHViUmVwb3MoKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mZXRjaEdpdEh1YkV2ZW50cygpLFxuICAgICAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgLi4udGhpcy5leHRyYWN0QmFzaWNQcm9maWxlKHByb2ZpbGUpLFxuICAgICAgICAgICAgICAgICAgICByZXBvc2l0b3JpZXM6IHJlcG9zRGF0YS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gcmVwb3NEYXRhLnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgcmVjZW50X2FjdGl2aXR5OiBldmVudHNEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyBldmVudHNEYXRhLnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBHaXRIdWIgc3RhdHM6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRXh0cmFjdCBiYXNpYyBwcm9maWxlIGZpZWxkcyBmb3IgY2xlYW5lciBjb2RlXG4gICAgICAgIGV4dHJhY3RCYXNpY1Byb2ZpbGUocHJvZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwdWJsaWNfcmVwb3M6IHByb2ZpbGUucHVibGljX3JlcG9zLFxuICAgICAgICAgICAgICAgIGZvbGxvd2VyczogcHJvZmlsZS5mb2xsb3dlcnMsXG4gICAgICAgICAgICAgICAgZm9sbG93aW5nOiBwcm9maWxlLmZvbGxvd2luZyxcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBwcm9maWxlLmNyZWF0ZWRfYXQsXG4gICAgICAgICAgICAgICAgYmlvOiBwcm9maWxlLmJpbyxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbjogcHJvZmlsZS5sb2NhdGlvbixcbiAgICAgICAgICAgICAgICBjb21wYW55OiBwcm9maWxlLmNvbXBhbnksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgZmV0Y2hHaXRIdWJSZXBvcygpIHtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IHRoaXMuYnVpbGRHaXRIdWJVcmwoYC9yZXBvcz9zb3J0PXVwZGF0ZWQmcGVyX3BhZ2U9JHtDSEFUQk9UX0NPTkZJRy5naXRodWIucmVwb0xpbWl0fWApO1xuICAgICAgICAgICAgY29uc3QgcmVwb3MgPSBhd2FpdCB0aGlzLmZldGNoR2l0SHViRGF0YSh1cmwsICdFcnJvciBmZXRjaGluZyBHaXRIdWIgcmVwb3NpdG9yaWVzOicpO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVwb3MgP1xuICAgICAgICAgICAgICAgIHJlcG9zXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIocmVwbyA9PiAhdGhpcy5zaG91bGRGaWx0ZXJSZXBvKHJlcG8pKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHRoaXMudHJhbnNmb3JtUmVwbykgOiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgYXN5bmMgZmV0Y2hHaXRIdWJFdmVudHMoKSB7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmJ1aWxkR2l0SHViVXJsKGAvZXZlbnRzP3Blcl9wYWdlPSR7Q0hBVEJPVF9DT05GSUcuZ2l0aHViLmV2ZW50TGltaXR9YCk7XG4gICAgICAgICAgICBjb25zdCBldmVudHMgPSBhd2FpdCB0aGlzLmZldGNoR2l0SHViRGF0YSh1cmwsICdFcnJvciBmZXRjaGluZyBHaXRIdWIgZXZlbnRzOicpO1xuXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRzID9cbiAgICAgICAgICAgICAgICBldmVudHNcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihldmVudCA9PiAhdGhpcy5zaG91bGRGaWx0ZXJFdmVudChldmVudCkpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAodGhpcy50cmFuc2Zvcm1FdmVudC5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGV2ZW50ID0+IGV2ZW50LnJlcG8pIDogbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYW5zZm9ybSByYXcgcmVwb3NpdG9yeSBkYXRhXG4gICAgICAgIHRyYW5zZm9ybVJlcG8ocmVwbykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiByZXBvLm5hbWUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlcG8uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2U6IHJlcG8ubGFuZ3VhZ2UsXG4gICAgICAgICAgICAgICAgc3RhcnM6IHJlcG8uc3RhcmdhemVyc19jb3VudCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiByZXBvLnVwZGF0ZWRfYXQsXG4gICAgICAgICAgICAgICAgdXJsOiByZXBvLmh0bWxfdXJsLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYW5zZm9ybSByYXcgZXZlbnQgZGF0YVxuICAgICAgICB0cmFuc2Zvcm1FdmVudChldmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBldmVudC50eXBlLFxuICAgICAgICAgICAgICAgIHJlcG86IGV2ZW50LnJlcG8/Lm5hbWUsXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogZXZlbnQuY3JlYXRlZF9hdCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IHRoaXMuZm9ybWF0RXZlbnRBY3Rpb24oZXZlbnQpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdEV2ZW50QWN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdQdXNoRXZlbnQnOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21taXRDb3VudCA9IGV2ZW50LnBheWxvYWQ/LmNvbW1pdHM/Lmxlbmd0aCB8fCAwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYFB1c2hlZCAke2NvbW1pdENvdW50fSBjb21taXQke2NvbW1pdENvdW50ICE9PSAxID8gJ3MnIDogJyd9YDtcbiAgICAgICAgICAgICAgICBjYXNlICdDcmVhdGVFdmVudCc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgQ3JlYXRlZCAke2V2ZW50LnBheWxvYWQ/LnJlZl90eXBlfSAke2V2ZW50LnBheWxvYWQ/LnJlZn1gO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1B1bGxSZXF1ZXN0RXZlbnQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYCR7ZXZlbnQucGF5bG9hZD8uYWN0aW9ufSBwdWxsIHJlcXVlc3RgO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0lzc3Vlc0V2ZW50JzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke2V2ZW50LnBheWxvYWQ/LmFjdGlvbn0gaXNzdWVgO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0ZvcmtFdmVudCc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnRm9ya2VkIHJlcG9zaXRvcnknO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1dhdGNoRXZlbnQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ1N0YXJyZWQgcmVwb3NpdG9yeSc7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50LnR5cGUucmVwbGFjZSgnRXZlbnQnLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYXRHaXRodWJTdGF0c0ZvckNvbnRleHQoc3RhdHMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXRCYXNpY0dpdEh1YlN0YXRzKHN0YXRzKSxcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdFJlcG9zaXRvcmllc1NlY3Rpb24oc3RhdHMucmVwb3NpdG9yaWVzKSxcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdEFjdGl2aXR5U2VjdGlvbihzdGF0cy5yZWNlbnRfYWN0aXZpdHkpLFxuICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYXRCYXNpY0dpdEh1YlN0YXRzKHN0YXRzKSB7XG4gICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgQ1VSUkVOVCBHSVRIVUIgU1RBVElTVElDUzpcbiAgICAgICAgICAgIC0gUHVibGljIHJlcG9zaXRvcmllczogJHtzdGF0cy5wdWJsaWNfcmVwb3N9XG4gICAgICAgICAgICAtIEZvbGxvd2VyczogJHtzdGF0cy5mb2xsb3dlcnN9XG4gICAgICAgICAgICAtIEZvbGxvd2luZzogJHtzdGF0cy5mb2xsb3dpbmd9XG4gICAgICAgICAgICAtIE1lbWJlciBzaW5jZTogJHtuZXcgRGF0ZShzdGF0cy5jcmVhdGVkX2F0KS5nZXRGdWxsWWVhcigpfVxuICAgICAgICAgICAgLSBCaW86ICR7c3RhdHMuYmlvfVxuICAgICAgICAgICAgLSBMb2NhdGlvbjogJHtzdGF0cy5sb2NhdGlvbn1cbiAgICAgICAgICAgIC0gQ29tcGFueTogJHtzdGF0cy5jb21wYW55fVxuICAgICAgICAgICAgYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdFJlcG9zaXRvcmllc1NlY3Rpb24ocmVwb3NpdG9yaWVzKSB7XG4gICAgICAgICAgICBpZiAoIXJlcG9zaXRvcmllcz8ubGVuZ3RoKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgcmVwb0xpc3QgPSByZXBvc2l0b3JpZXNcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgQ0hBVEJPVF9DT05GSUcuZ2l0aHViLmRpc3BsYXlSZXBvTGltaXQpXG4gICAgICAgICAgICAgICAgLm1hcCh0aGlzLmZvcm1hdFJlcG9zaXRvcnkpXG4gICAgICAgICAgICAgICAgLmpvaW4oJ1xcbiAgICAgICAgICAgICcpO1xuXG4gICAgICAgICAgICByZXR1cm4gYFxcbiAgICAgICAgICAgIFJFQ0VOVCBSRVBPU0lUT1JJRVM6XFxuICAgICAgICAgICAgJHtyZXBvTGlzdH1gO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9ybWF0UmVwb3NpdG9yeShyZXBvKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJ0cyA9IFtcbiAgICAgICAgICAgICAgICBgLSAke3JlcG8ubmFtZX1gLFxuICAgICAgICAgICAgICAgIHJlcG8ubGFuZ3VhZ2UgPyBgKCR7cmVwby5sYW5ndWFnZX0pYCA6ICcnLFxuICAgICAgICAgICAgICAgIHJlcG8uZGVzY3JpcHRpb24gPyBgLSAke3JlcG8uZGVzY3JpcHRpb259YCA6ICcnLFxuICAgICAgICAgICAgICAgIHJlcG8uc3RhcnMgPiAwID8gYOKtkCR7cmVwby5zdGFyc31gIDogJycsXG4gICAgICAgICAgICAgICAgYChVcGRhdGVkOiAke25ldyBEYXRlKHJlcG8udXBkYXRlZF9hdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9KWAsXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICByZXR1cm4gcGFydHMuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJyAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdEFjdGl2aXR5U2VjdGlvbihhY3Rpdml0aWVzKSB7XG4gICAgICAgICAgICBpZiAoIWFjdGl2aXRpZXM/Lmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IGFjdGl2aXR5TGlzdCA9IGFjdGl2aXRpZXNcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgQ0hBVEJPVF9DT05GSUcuZ2l0aHViLmRpc3BsYXlBY3Rpdml0eUxpbWl0KVxuICAgICAgICAgICAgICAgIC5tYXAodGhpcy5mb3JtYXRBY3Rpdml0eSlcbiAgICAgICAgICAgICAgICAuam9pbignXFxuICAgICAgICAgICAgJyk7XG5cbiAgICAgICAgICAgIHJldHVybiBgXFxuICAgICAgICAgICAgUkVDRU5UIEFDVElWSVRZOlxcbiAgICAgICAgICAgICR7YWN0aXZpdHlMaXN0fWA7XG4gICAgICAgIH1cblxuICAgICAgICBmb3JtYXRBY3Rpdml0eShhY3Rpdml0eSkge1xuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGFjdGl2aXR5LmNyZWF0ZWRfYXQpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xuICAgICAgICAgICAgY29uc3QgcmVwb05hbWUgPSBhY3Rpdml0eS5yZXBvLnJlcGxhY2UoJ01paGFpT25Tb2Z0d2FyZS8nLCAnJyk7XG4gICAgICAgICAgICByZXR1cm4gYC0gJHthY3Rpdml0eS5hY3Rpb259IGluICR7cmVwb05hbWV9ICgke2RhdGV9KWA7XG4gICAgICAgIH1cblxuICAgICAgICBhc3luYyBpbml0aWFsaXplKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmh0bWxDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5odG1sQ29udGVudCA9IGF3YWl0IHRoaXMubG9hZENvbnRlbnRGaWxlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3lzdGVtUHJvbXB0ID0gdGhpcy5jcmVhdGVTeXN0ZW1Qcm9tcHQodGhpcy5odG1sQ29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhZGRNZXNzYWdlVG9IaXN0b3J5KHJvbGUsIGNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7IHJvbGUsIGNvbnRlbnQsIHRpbWVzdGFtcDogbmV3IERhdGUoKSB9O1xuICAgICAgICAgICAgdGhpcy5jb252ZXJzYXRpb25IaXN0b3J5LnB1c2gobWVzc2FnZSk7XG4gICAgICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIGdldEdpdGh1YkNvbnRleHRJZk5lZWRlZChtZXNzYWdlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubWVzc2FnZVJlcXVpcmVzR2l0aHViU3RhdHMobWVzc2FnZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5mZXRjaEdpdEh1YlN0YXRzKCk7XG4gICAgICAgICAgICByZXR1cm4gc3RhdHMgPyB0aGlzLmZvcm1hdEdpdGh1YlN0YXRzRm9yQ29udGV4dChzdGF0cykgOiAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCc0MjknKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdoaWdoIGRlbWFuZCcpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSSdtIGN1cnJlbnRseSBleHBlcmllbmNpbmcgaGlnaCBkZW1hbmQuIFBsZWFzZSB3YWl0IGEgbW9tZW50IGFuZCB0cnkgYWdhaW4uIPCflZBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcIkknbSBzb3JyeSwgSSBlbmNvdW50ZXJlZCBhbiBlcnJvciBwcm9jZXNzaW5nIHlvdXIgbWVzc2FnZS4gUGxlYXNlIHRyeSBhZ2Fpbi5cIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIHByb2Nlc3NNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgICAgICB0aGlzLmFkZE1lc3NhZ2VUb0hpc3RvcnkoJ3VzZXInLCBtZXNzYWdlKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBnaXRodWJDb250ZXh0ID0gYXdhaXQgdGhpcy5nZXRHaXRodWJDb250ZXh0SWZOZWVkZWQobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQUlSZXNwb25zZShtZXNzYWdlLCBnaXRodWJDb250ZXh0KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYWRkTWVzc2FnZVRvSGlzdG9yeSgnYXNzaXN0YW50JywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBtZXNzYWdlOicsIGVycm9yKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2UgPSB0aGlzLmNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkTWVzc2FnZVRvSGlzdG9yeSgnYXNzaXN0YW50JywgZXJyb3JSZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yUmVzcG9uc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBidWlsZE1lc3NhZ2VzRm9yQUkobWVzc2FnZSwgZ2l0aHViQ29udGV4dCkge1xuICAgICAgICAgICAgY29uc3QgZnVsbFN5c3RlbVByb21wdCA9IHRoaXMuY3JlYXRlU3lzdGVtUHJvbXB0KHRoaXMuaHRtbENvbnRlbnQsIGdpdGh1YkNvbnRleHQpO1xuXG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6IGZ1bGxTeXN0ZW1Qcm9tcHQgfSxcbiAgICAgICAgICAgICAgICAuLi50aGlzLmNvbnZlcnNhdGlvbkhpc3Rvcnkuc2xpY2UoLTEwKSxcbiAgICAgICAgICAgICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogbWVzc2FnZSB9LFxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIGNhbGxPcGVuQUlBUEkobWVzc2FnZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvY2hhdCcsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiBDSEFUQk9UX0NPTkZJRy5vcGVuYWlNb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXM6IG1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiBDSEFUQk9UX0NPTkZJRy5tYXhUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBDSEFUQk9UX0NPTkZJRy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckRhdGEuZXJyb3IgfHwgYFNlcnZlciBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGFzeW5jIGdlbmVyYXRlQUlSZXNwb25zZShtZXNzYWdlLCBnaXRodWJDb250ZXh0KSB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMuYnVpbGRNZXNzYWdlc0ZvckFJKG1lc3NhZ2UsIGdpdGh1YkNvbnRleHQpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FsbE9wZW5BSUFQSShtZXNzYWdlcyk7XG4gICAgICAgIH1cblxuICAgICAgICBjbGVhckhpc3RvcnkoKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnZlcnNhdGlvbkhpc3RvcnkgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldEhpc3RvcnkoKSB7XG4gICAgICAgICAgICByZXR1cm4gWy4uLnRoaXMuY29udmVyc2F0aW9uSGlzdG9yeV07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYSBzaW5nbGV0b24gaW5zdGFuY2UgZm9yIHRoZSBicm93c2VyXG4gICAgbGV0IGNoYXRib3RJbnN0YW5jZSA9IG51bGw7XG5cbiAgICBmdW5jdGlvbiBnZXRDaGF0Ym90SW5zdGFuY2UoKSB7XG4gICAgICAgIGlmICghY2hhdGJvdEluc3RhbmNlKSB7XG4gICAgICAgICAgICBjaGF0Ym90SW5zdGFuY2UgPSBuZXcgQ2hhdGJvdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjaGF0Ym90SW5zdGFuY2U7XG4gICAgfVxuXG4gICAgLy8gUHVibGljIEFQSSBmdW5jdGlvbnMgdGhhdCB1c2UgdGhlIHNpbmdsZXRvblxuICAgIGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIGdldENoYXRib3RJbnN0YW5jZSgpLnByb2Nlc3NNZXNzYWdlKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFySGlzdG9yeSgpIHtcbiAgICAgICAgZ2V0Q2hhdGJvdEluc3RhbmNlKCkuY2xlYXJIaXN0b3J5KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0SGlzdG9yeSgpIHtcbiAgICAgICAgcmV0dXJuIGdldENoYXRib3RJbnN0YW5jZSgpLmdldEhpc3RvcnkoKTtcbiAgICB9XG5cbiAgICBhc3luYyBmdW5jdGlvbiBpbml0aWFsaXplQ2hhdGJvdCgpIHtcbiAgICAgICAgcmV0dXJuIGdldENoYXRib3RJbnN0YW5jZSgpLmluaXRpYWxpemUoKTtcbiAgICB9XG5cbiAgICAvLyBFeHBvcnQgZm9yIHRlc3RpbmdcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgICAgICAgICBDaGF0Ym90LFxuICAgICAgICAgICAgcHJvY2Vzc01lc3NhZ2UsXG4gICAgICAgICAgICBjbGVhckhpc3RvcnksXG4gICAgICAgICAgICBnZXRIaXN0b3J5LFxuICAgICAgICAgICAgaW5pdGlhbGl6ZUNoYXRib3QsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gTWFrZSBhdmFpbGFibGUgZ2xvYmFsbHkgZm9yIGJyb3dzZXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93LnByb2Nlc3NNZXNzYWdlID0gcHJvY2Vzc01lc3NhZ2U7XG4gICAgICAgIHdpbmRvdy5jbGVhckhpc3RvcnkgPSBjbGVhckhpc3Rvcnk7XG4gICAgICAgIHdpbmRvdy5nZXRIaXN0b3J5ID0gZ2V0SGlzdG9yeTtcbiAgICAgICAgd2luZG93LmluaXRpYWxpemVDaGF0Ym90ID0gaW5pdGlhbGl6ZUNoYXRib3Q7XG4gICAgfVxufSkoKTsgIiwiLyoqXG4gKiBDaGF0Ym90IEluaXRpYWxpemF0aW9uIFNjcmlwdFxuICogVGhpcyBzY3JpcHQgaW5pdGlhbGl6ZXMgdGhlIEFJLXBvd2VyZWQgY2hhdGJvdCBmb3IgTWloYWkncyBwZXJzb25hbCB3ZWJzaXRlXG4gKi9cblxuLy8gSW1wb3J0IHRoZSBjaGF0Ym90IGNvbXBvbmVudHNcbmltcG9ydCAnLi9jaGF0Ym90LmpzJztcbmltcG9ydCAnLi9jaGF0Ym90LXVpLmpzJztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBhdXRvSW5pdGlhbGl6ZUNoYXRib3QoKSB7XG4gICAgICAgIC8vIENyZWF0ZSBjb250YWluZXIgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXRib3QtY29udGFpbmVyJyk7XG4gICAgICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5pZCA9ICdjaGF0Ym90LWNvbnRhaW5lcic7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnQ2hhdGJvdCBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcbiAgICB9XG5cbiAgICAvLyBBdXRvLWluaXRpYWxpemUgd2hlbiBET00gaXMgbG9hZGVkIChsaWtlIG5hdmlnYXRpb24uanMpXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGF1dG9Jbml0aWFsaXplQ2hhdGJvdCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLyBVSSBDb25maWd1cmF0aW9uIChsaWtlIG5hdmlnYXRpb24uanMgY29uc3RhbnRzKVxuICAgIGNvbnN0IENIQVRCT1RfVUlfQ09ORklHID0ge1xuICAgICAgICBjb250YWluZXJJZDogJ2NoYXRib3QtY29udGFpbmVyJyxcbiAgICAgICAgd2VsY29tZURlbGF5OiA1MDAsXG4gICAgICAgIGZvY3VzRGVsYXk6IDEwMCxcbiAgICB9O1xuXG4gICAgLy8gVUkgVGVtcGxhdGUgKGxpa2UgbmF2aWdhdGlvbi5qcyBTT0NJQUxfTElOS1NfSFRNTClcbiAgICBjb25zdCBDSEFUQk9UX0hUTUwgPSBgXG4gICAgICA8ZGl2IGNsYXNzPVwiY2hhdGJvdC10b2dnbGVcIiB0aXRsZT1cIkNoYXQgd2l0aCBBSSBBc3Npc3RhbnRcIj5cbiAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtY29tbWVudHNcIj48L2k+XG4gICAgICA8L2Rpdj5cbiAgICAgIFxuICAgICAgPGRpdiBjbGFzcz1cImNoYXRib3Qtd2luZG93XCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdGJvdC1oZWFkZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdGJvdC10aXRsZVwiPlxuICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtcm9ib3RcIj48L2k+XG4gICAgICAgICAgICA8c3Bhbj5Bc2sgYWJvdXQgTWloYWk8L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImNoYXRib3QtY2xvc2VcIiB0aXRsZT1cIkNsb3NlIGNoYXRcIj5cbiAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFzIGZhLXRpbWVzXCI+PC9pPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjaGF0Ym90LW1lc3NhZ2VzXCI+PC9kaXY+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiY2hhdGJvdC1pbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICA8Zm9ybSBjbGFzcz1cImNoYXRib3QtaW5wdXQtZm9ybVwiPlxuICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiIFxuICAgICAgICAgICAgICBjbGFzcz1cImNoYXRib3QtaW5wdXRcIiBcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBc2sgbWUgYWJvdXQgbXkgZXhwZXJpZW5jZSwgc2tpbGxzLCBvciBwcm9qZWN0cy4uLlwiXG4gICAgICAgICAgICAgIGF1dG9jb21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgY2xhc3M9XCJjaGF0Ym90LXNlbmRcIiB0aXRsZT1cIlNlbmQgbWVzc2FnZVwiPlxuICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS1wYXBlci1wbGFuZVwiPjwvaT5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuXG4gICAgY29uc3QgV0VMQ09NRV9NRVNTQUdFID0gXCLwn5GLIEhpIHRoZXJlISBJJ20gYW4gQUkgYXNzaXN0YW50IHRoYXQgY2FuIGFuc3dlciBxdWVzdGlvbnMgYWJvdXQgTWloYWkgUG9wZXNjdS4gSSBrbm93IGFib3V0IGhpcyBleHBlcmllbmNlLCBza2lsbHMsIHByb2plY3RzLCBhbmQgY2FuIGV2ZW4gZmV0Y2ggaGlzIGxhdGVzdCBHaXRIdWIgc3RhdHMuIFdoYXQgd291bGQgeW91IGxpa2UgdG8ga25vdz9cIjtcblxuICAgIC8vIEdsb2JhbCBzdGF0ZSAobGlrZSBoYW1idXJnZXIuanMgc2ltcGxlIHN0YXRlKVxuICAgIGxldCBpc09wZW4gPSBmYWxzZTtcblxuICAgIC8vIEhlbHBlciBmdW5jdGlvbnMgKGxpa2UgaGFtYnVyZ2VyLmpzIGhlbHBlciBmdW5jdGlvbnMpXG4gICAgZnVuY3Rpb24gZm9ybWF0TWVzc2FnZSh0ZXh0KSB7XG4gICAgICAgIHJldHVybiB0ZXh0XG4gICAgICAgICAgICAucmVwbGFjZSgvXFwqXFwqKC4qPylcXCpcXCovZywgJzxzdHJvbmc+JDE8L3N0cm9uZz4nKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcKiguKj8pXFwqL2csICc8ZW0+JDE8L2VtPicpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxuL2csICc8YnI+JylcbiAgICAgICAgICAgIC5yZXBsYWNlKC8oY29udGVudFxcL1teXFxzXStcXC5odG1sKS9nLCAnPGEgaHJlZj1cIiQxXCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCJjaGF0Ym90LWxpbmtcIj4kMTwvYT4nKVxuICAgICAgICAgICAgLnJlcGxhY2UoL17igKIgL2dtLCAnPHNwYW4gY2xhc3M9XCJidWxsZXRcIj7igKI8L3NwYW4+ICcpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjcm9sbFRvQm90dG9tKCkge1xuICAgICAgICBjb25zdCBtZXNzYWdlc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LW1lc3NhZ2VzJyk7XG4gICAgICAgIGlmIChtZXNzYWdlc0NvbnRhaW5lcikge1xuICAgICAgICAgICAgbWVzc2FnZXNDb250YWluZXIuc2Nyb2xsVG8oe1xuICAgICAgICAgICAgICAgIHRvcDogbWVzc2FnZXNDb250YWluZXIuc2Nyb2xsSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkTWVzc2FnZShjb250ZW50LCBzZW5kZXIsIGlzRXJyb3IgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCBtZXNzYWdlc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LW1lc3NhZ2VzJyk7XG4gICAgICAgIGlmICghbWVzc2FnZXNDb250YWluZXIpIHJldHVybjtcblxuICAgICAgICBjb25zdCBtZXNzYWdlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBtZXNzYWdlRWxlbWVudC5jbGFzc05hbWUgPSBgbWVzc2FnZSAke3NlbmRlcn1gO1xuICAgICAgICBpZiAoaXNFcnJvcikgbWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTtcblxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRDb250ZW50ID0gZm9ybWF0TWVzc2FnZShjb250ZW50KTtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoW10sIHsgaG91cjogJzItZGlnaXQnLCBtaW51dGU6ICcyLWRpZ2l0JyB9KTtcblxuICAgICAgICBtZXNzYWdlRWxlbWVudC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1lc3NhZ2UtY29udGVudFwiPiR7Zm9ybWF0dGVkQ29udGVudH08L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZS10aW1lXCI+JHt0aW1lc3RhbXB9PC9kaXY+XG4gICAgICAgIGA7XG5cbiAgICAgICAgbWVzc2FnZXNDb250YWluZXIuYXBwZW5kQ2hpbGQobWVzc2FnZUVsZW1lbnQpO1xuICAgICAgICBzY3JvbGxUb0JvdHRvbSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNob3dUeXBpbmdJbmRpY2F0b3IoKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3QtbWVzc2FnZXMnKTtcbiAgICAgICAgaWYgKCFtZXNzYWdlc0NvbnRhaW5lcikgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgdHlwaW5nRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0eXBpbmdFbGVtZW50LmNsYXNzTmFtZSA9ICdtZXNzYWdlIGJvdCB0eXBpbmcnO1xuICAgICAgICB0eXBpbmdFbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZS1jb250ZW50XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidHlwaW5nLWluZGljYXRvclwiPlxuICAgICAgICAgICAgICA8c3Bhbj48L3NwYW4+XG4gICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj5cbiAgICAgICAgICAgICAgPHNwYW4+PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG5cbiAgICAgICAgbWVzc2FnZXNDb250YWluZXIuYXBwZW5kQ2hpbGQodHlwaW5nRWxlbWVudCk7XG4gICAgICAgIHNjcm9sbFRvQm90dG9tKCk7XG4gICAgICAgIHJldHVybiB0eXBpbmdFbGVtZW50O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZVR5cGluZ0luZGljYXRvcih0eXBpbmdFbGVtZW50KSB7XG4gICAgICAgIGlmICh0eXBpbmdFbGVtZW50ICYmIHR5cGluZ0VsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgdHlwaW5nRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHR5cGluZ0VsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdG9nZ2xlQ2hhdGJvdCgpIHtcbiAgICAgICAgY29uc3QgY2hhdGJvdFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LXdpbmRvdycpO1xuXG4gICAgICAgIGlmICghY2hhdGJvdFdpbmRvdykgcmV0dXJuO1xuXG4gICAgICAgIGlmIChpc09wZW4pIHtcbiAgICAgICAgICAgIGNsb3NlQ2hhdGJvdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhdGJvdFdpbmRvdy5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICAgICAgaXNPcGVuID0gdHJ1ZTtcblxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC1pbnB1dCcpO1xuICAgICAgICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBpbnB1dC5mb2N1cygpLCBDSEFUQk9UX1VJX0NPTkZJRy5mb2N1c0RlbGF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsb3NlQ2hhdGJvdCgpIHtcbiAgICAgICAgY29uc3QgY2hhdGJvdFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LXdpbmRvdycpO1xuICAgICAgICBpZiAoY2hhdGJvdFdpbmRvdykge1xuICAgICAgICAgICAgY2hhdGJvdFdpbmRvdy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBmdW5jdGlvbiBzZW5kTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgIGlmICghbWVzc2FnZS50cmltKCkpIHJldHVybjtcblxuICAgICAgICBhZGRNZXNzYWdlKG1lc3NhZ2UsICd1c2VyJyk7XG4gICAgICAgIGNvbnN0IHR5cGluZ0luZGljYXRvciA9IHNob3dUeXBpbmdJbmRpY2F0b3IoKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gQWNjZXNzIHByb2Nlc3NNZXNzYWdlIGZyb20gZ2xvYmFsIHNjb3BlIG9yIG1vZHVsZVxuICAgICAgICAgICAgY29uc3QgcHJvY2Vzc01lc3NhZ2VGbiA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wcm9jZXNzTWVzc2FnZVxuICAgICAgICAgICAgICAgID8gd2luZG93LnByb2Nlc3NNZXNzYWdlXG4gICAgICAgICAgICAgICAgOiAodHlwZW9mIHByb2Nlc3NNZXNzYWdlICE9PSAndW5kZWZpbmVkJyA/IHByb2Nlc3NNZXNzYWdlIDogbnVsbCk7XG5cbiAgICAgICAgICAgIGlmICghcHJvY2Vzc01lc3NhZ2VGbikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzc01lc3NhZ2UgZnVuY3Rpb24gbm90IGF2YWlsYWJsZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHByb2Nlc3NNZXNzYWdlRm4obWVzc2FnZSk7XG4gICAgICAgICAgICByZW1vdmVUeXBpbmdJbmRpY2F0b3IodHlwaW5nSW5kaWNhdG9yKTtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UocmVzcG9uc2UsICdib3QnKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJlbW92ZVR5cGluZ0luZGljYXRvcih0eXBpbmdJbmRpY2F0b3IpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2VuZGluZyBtZXNzYWdlOicsIGVycm9yKTtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UoJ1NvcnJ5LCBJIGVuY291bnRlcmVkIGFuIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLicsICdib3QnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYXRib3RDb250YWluZXIoKSB7XG4gICAgICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDSEFUQk9UX1VJX0NPTkZJRy5jb250YWluZXJJZCk7XG4gICAgICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5pZCA9IENIQVRCT1RfVUlfQ09ORklHLmNvbnRhaW5lcklkO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGNvbnN0IHRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LXRvZ2dsZScpO1xuICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LWNsb3NlJyk7XG4gICAgICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2hhdGJvdC1pbnB1dC1mb3JtJyk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoYXRib3QtaW5wdXQnKTtcblxuICAgICAgICBpZiAodG9nZ2xlKSB7XG4gICAgICAgICAgICB0b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVDaGF0Ym90KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjbG9zZUJ0bikge1xuICAgICAgICAgICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUNoYXRib3QpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZvcm0pIHtcbiAgICAgICAgICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGlucHV0LnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbnB1dCkge1xuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAhZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N1Ym1pdCcpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hvd1dlbGNvbWVNZXNzYWdlKCkge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UoV0VMQ09NRV9NRVNTQUdFLCAnYm90Jyk7XG4gICAgICAgIH0sIENIQVRCT1RfVUlfQ09ORklHLndlbGNvbWVEZWxheSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJDaGF0KCkge1xuICAgICAgICBjb25zdCBtZXNzYWdlc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGF0Ym90LW1lc3NhZ2VzJyk7XG4gICAgICAgIGlmIChtZXNzYWdlc0NvbnRhaW5lcikge1xuICAgICAgICAgICAgbWVzc2FnZXNDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBY2Nlc3MgY2xlYXJIaXN0b3J5IGZyb20gZ2xvYmFsIHNjb3BlIG9yIG1vZHVsZVxuICAgICAgICBjb25zdCBjbGVhckhpc3RvcnlGbiA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5jbGVhckhpc3RvcnlcbiAgICAgICAgICAgID8gd2luZG93LmNsZWFySGlzdG9yeVxuICAgICAgICAgICAgOiAodHlwZW9mIGNsZWFySGlzdG9yeSAhPT0gJ3VuZGVmaW5lZCcgPyBjbGVhckhpc3RvcnkgOiBudWxsKTtcblxuICAgICAgICBpZiAoY2xlYXJIaXN0b3J5Rm4pIHtcbiAgICAgICAgICAgIGNsZWFySGlzdG9yeUZuKCk7XG4gICAgICAgIH1cblxuICAgICAgICBzaG93V2VsY29tZU1lc3NhZ2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhdXRvSW5pdGlhbGl6ZUNoYXRib3QoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGNyZWF0ZUNoYXRib3RDb250YWluZXIoKTtcbiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IENIQVRCT1RfSFRNTDtcbiAgICAgICAgYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgc2hvd1dlbGNvbWVNZXNzYWdlKCk7XG4gICAgfVxuXG4gICAgLy8gRXhwb3J0IGZvciB0ZXN0aW5nIChsaWtlIGhhbWJ1cmdlci5qcyBleHBvcnRzKVxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAgICAgICAgIHRvZ2dsZUNoYXRib3QsXG4gICAgICAgICAgICBzZW5kTWVzc2FnZSxcbiAgICAgICAgICAgIGNsZWFyQ2hhdCxcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gTWFrZSBhdmFpbGFibGUgZ2xvYmFsbHkgKGxpa2UgaGFtYnVyZ2VyLmpzKVxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3aW5kb3cudG9nZ2xlQ2hhdGJvdCA9IHRvZ2dsZUNoYXRib3Q7XG4gICAgICAgIHdpbmRvdy5jbGVhckNoYXQgPSBjbGVhckNoYXQ7XG4gICAgICAgIHdpbmRvdy5zZW5kTWVzc2FnZSA9IHNlbmRNZXNzYWdlO1xuICAgICAgICB3aW5kb3cuYWRkTWVzc2FnZSA9IGFkZE1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLy8gQXV0by1pbml0aWFsaXplIChsaWtlIG5hdmlnYXRpb24uanMpXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGF1dG9Jbml0aWFsaXplQ2hhdGJvdCk7XG59KSgpOyAiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxuX193ZWJwYWNrX3JlcXVpcmVfXygyMjcpO1xuX193ZWJwYWNrX3JlcXVpcmVfXyg2ODgyKTtcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Njk0KTtcbiJdLCJuYW1lcyI6WyJDSEFUQk9UX0NPTkZJRyIsImdpdGh1YlVzZXJuYW1lIiwib3BlbmFpTW9kZWwiLCJtYXhUb2tlbnMiLCJ0ZW1wZXJhdHVyZSIsImdpdGh1YktleXdvcmRzIiwiZ2l0aHViIiwiYmFzZVVybCIsInJlcG9MaW1pdCIsImV2ZW50TGltaXQiLCJkaXNwbGF5UmVwb0xpbWl0IiwiZGlzcGxheUFjdGl2aXR5TGltaXQiLCJleGNsdWRlUGF0dGVybnMiLCJDaGF0Ym90IiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiaHRtbENvbnRlbnQiLCJzeXN0ZW1Qcm9tcHQiLCJjb252ZXJzYXRpb25IaXN0b3J5IiwibG9hZENvbnRlbnRJbmRleCIsImluZGV4UmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJqc29uIiwibG9hZFNpbmdsZUNvbnRlbnRGaWxlIiwiZmlsZW5hbWUiLCJyZXNwb25zZSIsImNvbnRlbnQiLCJ0ZXh0IiwiZmlsZVR5cGUiLCJlbmRzV2l0aCIsImxvYWRBbGxDb250ZW50RmlsZXMiLCJjb250ZW50RmlsZXMiLCJjb21iaW5lZENvbnRlbnQiLCJsb2FkQ29udGVudEZpbGVzIiwiY3JlYXRlU3lzdGVtUHJvbXB0IiwiY29udGVudERhdGEiLCJnaXRodWJDb250ZXh0IiwibWVzc2FnZVJlcXVpcmVzR2l0aHViU3RhdHMiLCJtZXNzYWdlIiwibG93ZXJNZXNzYWdlIiwidG9Mb3dlckNhc2UiLCJzb21lIiwia2V5d29yZCIsImluY2x1ZGVzIiwic2hvdWxkRmlsdGVyUmVwbyIsInJlcG8iLCJyZXBvVXJsIiwiaHRtbF91cmwiLCJ1cmwiLCJyZXBvTmFtZSIsIm5hbWUiLCJmdWxsTmFtZSIsImZ1bGxfbmFtZSIsInBhdHRlcm4iLCJzaG91bGRGaWx0ZXJFdmVudCIsImV2ZW50IiwiYnVpbGRHaXRIdWJVcmwiLCJlbmRwb2ludCIsImZldGNoR2l0SHViRGF0YSIsImVycm9yTWVzc2FnZSIsImVycm9yIiwiY29uc29sZSIsImZldGNoR2l0SHViU3RhdHMiLCJwcm9maWxlIiwicmVwb3NEYXRhIiwiZXZlbnRzRGF0YSIsIlByb21pc2UiLCJhbGxTZXR0bGVkIiwiZmV0Y2hHaXRIdWJSZXBvcyIsImZldGNoR2l0SHViRXZlbnRzIiwiZXh0cmFjdEJhc2ljUHJvZmlsZSIsInJlcG9zaXRvcmllcyIsInZhbHVlIiwicmVjZW50X2FjdGl2aXR5IiwicHVibGljX3JlcG9zIiwiZm9sbG93ZXJzIiwiZm9sbG93aW5nIiwiY3JlYXRlZF9hdCIsImJpbyIsImxvY2F0aW9uIiwiY29tcGFueSIsInJlcG9zIiwiZmlsdGVyIiwibWFwIiwidHJhbnNmb3JtUmVwbyIsImV2ZW50cyIsInRyYW5zZm9ybUV2ZW50IiwiYmluZCIsImRlc2NyaXB0aW9uIiwibGFuZ3VhZ2UiLCJzdGFycyIsInN0YXJnYXplcnNfY291bnQiLCJ1cGRhdGVkX2F0IiwidHlwZSIsImFjdGlvbiIsImZvcm1hdEV2ZW50QWN0aW9uIiwiY29tbWl0Q291bnQiLCJwYXlsb2FkIiwiY29tbWl0cyIsImxlbmd0aCIsInJlZl90eXBlIiwicmVmIiwicmVwbGFjZSIsImZvcm1hdEdpdGh1YlN0YXRzRm9yQ29udGV4dCIsInN0YXRzIiwiZm9ybWF0QmFzaWNHaXRIdWJTdGF0cyIsImZvcm1hdFJlcG9zaXRvcmllc1NlY3Rpb24iLCJmb3JtYXRBY3Rpdml0eVNlY3Rpb24iLCJCb29sZWFuIiwiam9pbiIsIkRhdGUiLCJnZXRGdWxsWWVhciIsInNsaWNlIiwiZm9ybWF0UmVwb3NpdG9yeSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsImFjdGl2aXRpZXMiLCJmb3JtYXRBY3Rpdml0eSIsImFjdGl2aXR5IiwiZGF0ZSIsImluaXRpYWxpemUiLCJhZGRNZXNzYWdlVG9IaXN0b3J5Iiwicm9sZSIsInRpbWVzdGFtcCIsInB1c2giLCJnZXRHaXRodWJDb250ZXh0SWZOZWVkZWQiLCJjcmVhdGVFcnJvclJlc3BvbnNlIiwicHJvY2Vzc01lc3NhZ2UiLCJnZW5lcmF0ZUFJUmVzcG9uc2UiLCJlcnJvclJlc3BvbnNlIiwiYnVpbGRNZXNzYWdlc0ZvckFJIiwiY2FsbE9wZW5BSUFQSSIsIm1lc3NhZ2VzIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibW9kZWwiLCJtYXhfdG9rZW5zIiwiZXJyb3JEYXRhIiwiY2F0Y2giLCJjaG9pY2VzIiwiY2xlYXJIaXN0b3J5IiwiZ2V0SGlzdG9yeSIsImNoYXRib3RJbnN0YW5jZSIsImdldENoYXRib3RJbnN0YW5jZSIsImFzeW5jIiwiaW5pdGlhbGl6ZUNoYXRib3QiLCJtb2R1bGUiLCJleHBvcnRzIiwid2luZG93IiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJhcHBlbmRDaGlsZCIsImxvZyIsIkNIQVRCT1RfVUlfQ09ORklHIiwiaXNPcGVuIiwic2Nyb2xsVG9Cb3R0b20iLCJtZXNzYWdlc0NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JvbGxUbyIsInRvcCIsInNjcm9sbEhlaWdodCIsImJlaGF2aW9yIiwiYWRkTWVzc2FnZSIsInNlbmRlciIsImlzRXJyb3IiLCJtZXNzYWdlRWxlbWVudCIsImNsYXNzTmFtZSIsImNsYXNzTGlzdCIsImFkZCIsImZvcm1hdHRlZENvbnRlbnQiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJob3VyIiwibWludXRlIiwiaW5uZXJIVE1MIiwicmVtb3ZlVHlwaW5nSW5kaWNhdG9yIiwidHlwaW5nRWxlbWVudCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsInRvZ2dsZUNoYXRib3QiLCJjaGF0Ym90V2luZG93IiwiY2xvc2VDaGF0Ym90Iiwic3R5bGUiLCJkaXNwbGF5IiwiaW5wdXQiLCJzZXRUaW1lb3V0IiwiZm9jdXMiLCJzZW5kTWVzc2FnZSIsInRyaW0iLCJ0eXBpbmdJbmRpY2F0b3IiLCJzaG93VHlwaW5nSW5kaWNhdG9yIiwicHJvY2Vzc01lc3NhZ2VGbiIsInNob3dXZWxjb21lTWVzc2FnZSIsImNsZWFyQ2hhdCIsImNsZWFySGlzdG9yeUZuIiwiY3JlYXRlQ2hhdGJvdENvbnRhaW5lciIsInRvZ2dsZSIsImNsb3NlQnRuIiwiZm9ybSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImtleSIsInNoaWZ0S2V5IiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwiYXR0YWNoRXZlbnRMaXN0ZW5lcnMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibiIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiYSIsImRlZmluaXRpb24iLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCJdLCJzb3VyY2VSb290IjoiIn0=